(this["webpackJsonprap2-dolores"]=this["webpackJsonprap2-dolores"]||[]).push([[8],{741:function(e,t,a){},750:function(e,t,a){},751:function(e,t,a){},752:function(e,t,a){},798:function(e,t,a){"use strict";a.r(t);var n=a(31),r=a(32),o=a(34),l=a(33),c=a(0),i=a.n(c),s=a(62),m=a(8),u=a(52),d=a(273),p=a(3),f=a(276),h=a(777),v=a(666),E=a(715),b=a(740),y=a.n(b),g=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.clip,n=e.seed,r={__html:a.replace(t,n)};return i.a.createElement("span",Object.assign({},this.props,{dangerouslySetInnerHTML:r}))}}]),a}(c.Component);g.replace=function(e,t){if(!t)return e;var a=new RegExp(t,"ig");return(""+e).replace(a,(function(e){return"<span class='highlight'>".concat(e,"</span>")}))};var O=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.repository,a=e.seed,n=e.onSelect,r=e.router,o=Object(s.e)(r).removeSearch("mod").removeSearch("itf"),l=N.filter(t,a),c=l.nextRespository;return 0===l.counter?null:i.a.createElement("div",{className:"dropdown-menu"},c.modules.map((function(e,t,r){return i.a.createElement("div",{key:"mod-".concat(e.id)},i.a.createElement(s.a,{to:o.setSearch({mod:e.id}).href(),onClick:n,className:"dropdown-item dropdown-item-module"},i.a.createElement("span",{className:"label"},"\u6a21\u5757"),i.a.createElement(g,{className:"dropdown-item-clip",clip:e.name,seed:a})),e.interfaces.map((function(e){return i.a.createElement("div",{key:"itf-".concat(e.id)},i.a.createElement(s.a,{to:o.setSearch({mod:e.moduleId}).setSearch({itf:e.id}).href(),onClick:n,className:"dropdown-item dropdown-item-interface"},i.a.createElement("span",{className:"label"},"\u63a5\u53e3"),i.a.createElement(g,{className:"dropdown-item-clip",clip:e.name,seed:a}),i.a.createElement(g,{className:"dropdown-item-clip",clip:e.method,seed:a}),i.a.createElement(g,{className:"dropdown-item-clip",clip:e.url,seed:a})),e.properties.map((function(e){return i.a.createElement(s.a,{key:"property-".concat(e.id),to:o.setSearch({mod:e.moduleId}).setSearch({itf:e.interfaceId}).href(),onClick:n,className:"dropdown-item dropdown-item-property"},i.a.createElement("span",{className:"label"},"\u5c5e\u6027"),i.a.createElement(g,{className:"dropdown-item-clip",clip:e.name,seed:a}))})))})),t<r.length-1&&i.a.createElement("div",{className:"dropdown-divider"}))})))}}]),a}(c.Component);O.contextTypes={store:s.c.object},O.filter=function(e,t){var a=Object(p.a)(Object(p.a)({},e),{},{modules:[]}),n=0;return t=t.toLowerCase(),e.modules.forEach((function(e){var r=Object(p.a)(Object(p.a)({},e),{},{interfaces:[]}),o=-1!==r.name.toLowerCase().indexOf(t);o&&(n++,a.modules.push(r)),e.interfaces.forEach((function(e){var l=Object(p.a)(Object(p.a)({},e),{},{properties:[]});(-1!==l.name.toLowerCase().indexOf(t)||-1!==l.url.toLowerCase().indexOf(t)||l.method===t||l.id===+t)&&(n++,o||(o=!0,a.modules.push(r)),r.interfaces.push(l))}))})),{nextRespository:a,counter:n}},O.highlight=function(e,t){if(!t)return e;var a=new RegExp(t,"ig");return(""+e).replace(a,(function(e){return"<span class='highlight'>".concat(e,"</span>")}))};var N=Object(s.i)((function(e){return{router:e.router}}))(O),j=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).debouncedInput=Object(h.a)((function(e){return r.setState({result:e})}),300),r.clearSeed=function(){r.setState({seed:"",result:""})},r.state={seed:"",result:""},r.debouncedInput=r.debouncedInput.bind(Object(f.a)(r)),r}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.props.repository,a=this.state,n=a.seed,r=a.result;return i.a.createElement("div",{className:"RepositorySearcher dropdown"},i.a.createElement(v.a,{value:n,onChange:function(t){var a=t.target.value;e.setState({seed:a}),e.debouncedInput(a.trim())},style:{backgroundColor:"#fafbfc",marginRight:12},className:"dropdown-input form-control",placeholder:"\u68c0\u7d22\u540d\u79f0\u6216ID",InputProps:{endAdornment:i.a.createElement(E.a,{position:"end"},i.a.createElement(y.a,null))}}),r&&i.a.createElement(N,{repository:t,seed:r,onSelect:this.clearSeed}))}}]),a}(c.Component),k=Object(s.i)((function(e){return{router:e.router}}))(j),C=a(28),I=a(19),S=a(167),w=a(60),P=a(109),R=a(98),x=a(215),T=a(216),D=a(217),M=a(120),A=a(270),_=a(121),L=a(78),U=Object(A.a)((function(e){var t=e.spacing;return{root:{},appBar:{position:"relative"},title:{marginLeft:t(2),flex:1},preview:{marginTop:t(1)},form:{minWidth:500},formTitle:{color:"rgba(0, 0, 0, 0.54)",fontSize:9},formItem:{marginBottom:t(1)},ctl:{marginTop:t(3)}}})),q=R.object().shape({name:R.string().required(S.b.REQUIRED).max(20,S.b.MAX_LENGTH(20)),description:R.string().max(1e3,S.b.MAX_LENGTH(1e3))}),B={id:0,name:"",description:"",repositoryid:0,priority:1};var F=function(e){var t=Object(I.e)((function(e){return e.auth})),a=e.open,n=e.onClose,r=e.module,o=e.title,l=e.repository,c=U(),s=Object(I.d)();return i.a.createElement(x.a,{open:a,onClose:function(e,t){return"backdropClick"!==t&&n()},TransitionComponent:_.a},i.a.createElement(T.a,null,o),i.a.createElement(D.a,{dividers:!0},i.a.createElement("div",{className:c.form},i.a.createElement(w.c,{initialValues:Object(p.a)(Object(p.a)({},B),r||{}),validationSchema:q,onSubmit:function(e){var a=e.id?L.k:L.a,r=Object(p.a)(Object(p.a)({},e),{},{creatorId:t.id,repositoryId:l.id});s(a(r,(function(){n(!0)})))},render:function(e){var t=e.isSubmitting;return i.a.createElement(w.b,null,i.a.createElement("div",{className:"rmodal-body"},i.a.createElement("div",{className:c.formItem},i.a.createElement(w.a,{name:"name",label:"\u6a21\u5757\u540d\u79f0",component:P.a,fullWidth:!0})),i.a.createElement("div",{className:c.formItem},i.a.createElement(w.a,{name:"description",label:"\u6a21\u5757\u7b80\u4ecb",component:P.a,multiline:!0,fullWidth:!0}))),i.a.createElement("div",{className:c.ctl},i.a.createElement(M.a,{type:"submit",variant:"contained",color:"primary",className:"mr1",disabled:t},"\u63d0\u4ea4"),i.a.createElement(M.a,{onClick:function(){return n()},disabled:t},"\u53d6\u6d88")))}}))))},z=a(166),W=a(388);var H={deleteModule:L.d,replace:s.n},Y=Object(s.i)((function(e){return{router:e.router}}),H)((function(e){var t=e.mod,a=Object(I.e)((function(e){return e.router})),n=Object(s.e)(a).removeSearch("itf").setSearch("mod",t.id.toString()).href();return i.a.createElement("div",{className:"Module clearfix"},i.a.createElement(s.a,{to:n,className:"name"},t.name))})),J=Object(W.a)((function(e){var t=e.palette;return{li:{borderColor:"".concat(t.primary.main," #e1e4e8 transparent #e1e4e8 !important")}}}));var G={replace:s.n},Q=Object(s.i)((function(e){return{auth:e.auth,router:e.router}}),G)((function(e){var t=Object(c.useState)(!1),a=Object(C.a)(t,2),n=a[0],r=a[1],o=Object(I.d)(),l=Object(I.e)((function(e){return e.auth})),s=e.repository,m=e.mods,d=void 0===m?[]:m,p=e.mod,f=J();return i.a.createElement(u.h,{onChange:function(e,t){o(Object(L.h)(t.toArray(),(function(){})))},disabled:!s.canUserEdit},i.a.createElement("ul",{className:"ModuleList clearfix"},d.map((function(e){return i.a.createElement("li",{key:e.id,className:"".concat(e.id===p.id?"active "+f.li:""," sortable "),"data-id":e.id},i.a.createElement(Y,{key:e.id,mod:e,active:e.id===p.id,repository:s,auth:l}))})),s.canUserEdit?i.a.createElement("li",null,i.a.createElement("span",{onClick:function(){return r(!0)},className:"g-link"},i.a.createElement(z.n,{className:"fontsize-14"})," \u65b0\u5efa\u6a21\u5757"),i.a.createElement(F,{title:"\u65b0\u5efa\u6a21\u5757",repository:s,open:n,onClose:function(){return r(!1)}})):null))})),X=a(35),V=a(669),$=a(670),K=a(673),Z=a(664),ee=["GET","POST","PUT","DELETE","OPTIONS","PATCH","HEAD"],te=[200,301,403,404,500,502,503,504],ae=Object(A.a)((function(e){var t=e.spacing;return{root:{},appBar:{position:"relative"},title:{marginLeft:t(2),flex:1},preview:{marginTop:t(1)},form:{minWidth:500,minHeight:300},formTitle:{color:"rgba(0, 0, 0, 0.54)",fontSize:9},formItem:{marginBottom:t(1)},ctl:{marginTop:t(3)}}})),ne=R.object().shape({name:R.string().required(S.b.REQUIRED).max(20,S.b.MAX_LENGTH(20)),description:R.string().max(1e3,S.b.MAX_LENGTH(1e3))}),re={id:0,name:"",url:"",method:"GET",description:"",repositoryId:0,moduleId:0,status:200};var oe=function(e){var t=Object(I.e)((function(e){return e.auth})),a=e.open,n=e.onClose,r=e.itf,o=e.title,l=e.repository,c=e.mod,m=ae(),u=Object(I.d)(),d=Object(I.e)((function(e){return e.router}));return i.a.createElement(x.a,{open:a,onClose:function(e,t){return"backdropClick"!==t&&n()},TransitionComponent:_.a},i.a.createElement(T.a,null,o),i.a.createElement(D.a,{dividers:!0},i.a.createElement("div",{className:m.form},i.a.createElement(w.c,{initialValues:Object(p.a)(Object(p.a)({},re),r||{}),validationSchema:ne,onSubmit:function(e){var a=e.id?X.y:X.a,r=Object(p.a)(Object(p.a)({},e),{},{creatorId:t.id,repositoryId:l.id,moduleId:c.id});u(a(r,(function(e){if(e&&e.id){var t=Object(s.e)(d).setSearch("itf",e.id).href();u(Object(s.l)(t))}n(!0)})))},render:function(e){var t=e.isSubmitting,a=e.setFieldValue,r=e.values;return i.a.createElement(w.b,null,i.a.createElement("div",{className:"rmodal-body"},i.a.createElement("div",{className:m.formItem},i.a.createElement(w.a,{name:"name",label:"\u540d\u79f0",component:P.a,fullWidth:!0})),i.a.createElement("div",{className:m.formItem},i.a.createElement(w.a,{name:"url",label:"URL\u5730\u5740",component:P.a,fullWidth:!0})),i.a.createElement("div",{className:m.formItem},i.a.createElement(V.a,null,i.a.createElement($.a,{shrink:!0,htmlFor:"method-label-placeholder"},"\u7c7b\u578b"),i.a.createElement(K.a,{value:r.method,displayEmpty:!0,name:"method",onChange:function(e){a("method",e.target.value)}},ee.map((function(e){return i.a.createElement(Z.a,{key:e,value:e},e)}))))),i.a.createElement("div",{className:m.formItem},i.a.createElement($.a,{shrink:!0,htmlFor:"method-label-placeholder"},"\u72b6\u6001\u7801"),i.a.createElement(K.a,{value:r.status,displayEmpty:!0,name:"status",onChange:function(e){a("status",e.target.value)}},te.map((function(e){return i.a.createElement(Z.a,{key:e,value:e},e)})))),i.a.createElement("div",{className:m.formItem},i.a.createElement(w.a,{name:"description",label:"\u8bf4\u660e",component:P.a,multiline:!0,fullWidth:!0}))),i.a.createElement("div",{className:m.ctl},i.a.createElement(M.a,{type:"submit",variant:"contained",color:"primary",className:"mr1",disabled:t},"\u63d0\u4ea4"),i.a.createElement(M.a,{onClick:function(){return n()},disabled:t},"\u53d6\u6d88")))}}))))},le=a(355),ce=a(219),ie=a(350),se=a(196),me=Object(ie.a)((function(e){var t=Object(se.a)(e),a=+(t.location.params||t.location.query).itf;if(a>0){var n,r=Object(ce.a)(e.repository.data.modules);try{for(r.s();!(n=r.n()).done;){var o,l=n.value,c=Object(ce.a)(l.interfaces);try{for(c.s();!(o=c.n()).done;){var i=o.value;if(i.id===a)return i}}catch(s){c.e(s)}finally{c.f()}}}catch(s){r.e(s)}finally{r.f()}}return null}),(function(e){return e})),ue=(Object(ie.a)((function(e){return e.repository.data}),se.a,(function(e,t){var a,n,r,o=+(t.location.params||t.location.query).itf;if(o)return o;var l=+(t.location.params||t.location.query).mod,c=l?null===e||void 0===e||null===(a=e.modules)||void 0===a?void 0:a.find((function(e){return e.id===l})):null===e||void 0===e?void 0:e.modules[0];return null===c||void 0===c||null===(n=c.interfaces)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.id})),a(783)),de=a(27),pe=a(13),fe=a(63),he=a.n(fe),ve=a(676),Ee=a(394),be=a(396),ye=Object(W.a)((function(e){var t=e.spacing;return{root:{},appBar:{position:"relative"},title:{marginLeft:t(2),flex:1},preview:{marginTop:t(1)},form:{minWidth:500},formTitle:{color:"rgba(0, 0, 0, 0.54)",fontSize:9},formItem:{marginBottom:t(1)},ctl:{marginTop:t(2)},select:{width:t(20)}}}));function ge(e){var t=e.repository,a=e.title,n=e.onClose,r=e.open,o=e.mod.id,l=ye(),s=Object(c.useState)(t.id),m=Object(C.a)(s,2),u=m[0],d=m[1],p=Object(c.useState)(1),f=Object(C.a)(p,2),h=f[0],v=f[1],E=Object(I.d)(),b=Object(I.e)((function(e){return he.a.uniqBy([].concat(Object(de.a)(e.ownedRepositories.data),Object(de.a)(e.joinedRepositories.data)),"id")}));Object(c.useEffect)((function(){b.length||(E(Object(pe.k)()),E(Object(pe.n)()))}),[E,b.length]);return i.a.createElement(x.a,{open:r,onClose:function(e,t){return"backdropClick"!==t&&n()},TransitionComponent:_.a},i.a.createElement(T.a,null,a),i.a.createElement(D.a,{dividers:!0},i.a.createElement("form",{className:l.form,onSubmit:function(e){e.preventDefault();var t={modId:o,op:h,repositoryId:u};E(Object(L.g)(t,(function(){n()})))}},i.a.createElement("div",{className:"rmodal-body"},i.a.createElement("div",{style:{color:"#CC0000",fontSize:16,marginBottom:8}},"\u8bf7\u6ce8\u610f\u8fd9\u91cc\u662f\u79fb\u52a8\u6a21\u5757\uff0c\u6574\u4e2a\u6a21\u5757\u54e6\uff0c\u4e0d\u662f\u79fb\u52a8\u63a5\u53e3\u3002\u522b\u641e\u9519\u5566\uff01\uff01\uff01"),i.a.createElement("div",{className:l.formItem},i.a.createElement("div",{className:l.formTitle},"\u9009\u62e9\u76ee\u6807\u4ed3\u5e93\uff1a"),i.a.createElement(V.a,null,i.a.createElement(K.a,{className:l.select,onChange:function(e){var t=e.target.value;d(t)},value:u,fullWidth:!0},b.map((function(e){return i.a.createElement(Z.a,{key:e.id,value:e.id},e.name)}))))),i.a.createElement("div",{className:l.formItem},i.a.createElement("div",{className:l.formTitle},"\u64cd\u4f5c\u7c7b\u578b\uff1a"),i.a.createElement(ve.a,{name:"radioListOp",value:String(h),onChange:function(e){v(+e.target.value)},row:!0},i.a.createElement(Ee.a,{value:String(1),control:i.a.createElement(be.a,null),label:"\u79fb\u52a8"}),i.a.createElement(Ee.a,{value:String(2),control:i.a.createElement(be.a,null),label:"\u590d\u5236"}))),i.a.createElement("div",{className:l.ctl},i.a.createElement(M.a,{type:"submit",variant:"contained",color:"primary",style:{marginRight:8}},"\u63d0\u4ea4"),i.a.createElement(M.a,{onClick:function(){return n()}},"\u53d6\u6d88"))))))}a(741);var Oe=function(e){return{curItf:me(e),router:e.router}},Ne={replace:s.n,deleteInterface:X.d,unlockInterface:X.v},je=Object(s.i)(Oe,Ne)((function(e){var t=e.repository,a=e.mod,n=e.itf,r=e.curItf,o=e.unlockInterface,l=Object(I.e)((function(e){return e.auth})),m=Object(I.e)((function(e){return e.router})),u=Object(s.e)(m).setSearch("itf",n.id.toString()).href(),d=Object(c.useState)(!1),p=Object(C.a)(d,2),f=p[0],h=p[1];return i.a.createElement("div",{className:"Interface clearfix"},i.a.createElement("span",null,i.a.createElement(s.a,{to:u,onClick:function(e){if(r&&r.locker)window.confirm("\u7f16\u8f91\u6a21\u5f0f\u4e0b\u5207\u6362\u63a5\u53e3\uff0c\u4f1a\u5bfc\u81f4\u7f16\u8f91\u4e2d\u7684\u8d44\u6599\u4e22\u5931\uff0c\u662f\u5426\u786e\u5b9a\u5207\u6362\u63a5\u53e3\uff1f")?o(r.id):e.preventDefault();else{var t=document.querySelector(".InterfaceEditor").offsetTop-10;window.scrollY>t&&window.scrollTo(0,t)}}},i.a.createElement("div",{className:"name"},n.name),i.a.createElement("div",{className:"url"},n.url))),t.canUserEdit?i.a.createElement("div",{className:"toolbar"},n.locker?i.a.createElement("span",{className:"locked mr5"},i.a.createElement(z.l,null)):null,n.locker&&n.locker.id!==l.id?null:i.a.createElement("span",{className:"fake-link",onClick:function(){return h(!0)}},i.a.createElement(z.o,null)),i.a.createElement(oe,{title:"\u4fee\u6539\u63a5\u53e3",repository:t,mod:a,itf:n,open:f,onClose:function(){return h(!1)}}),n.locker?null:i.a.createElement(s.a,{to:"",onClick:function(t){t.preventDefault();var a="\u63a5\u53e3\u88ab\u5220\u9664\u540e\u4e0d\u53ef\u6062\u590d\uff01\n\u786e\u8ba4\u7ee7\u7eed\u5220\u9664\u300e#".concat(n.id," ").concat(n.name,"\u300f\u5417\uff1f");if(window.confirm(a)){(0,e.deleteInterface)(e.itf.id,(function(){}));var r=m.location,o=r.pathname,l=r.hash,c=r.search;Object(s.n)(o+l+c)}}},i.a.createElement(z.x,null))):null)})),ke=Object(W.a)((function(e){var t=e.palette;return{interface:{border:"1px solid ".concat(t.primary.main)},interfaceActive:{borderLeft:"3px solid ".concat(t.primary.main)},li:{borderBottom:"1px solid ".concat(t.primary.main)}}}));var Ce=Object(s.i)(Oe,Ne)((function(e){var t=Object(c.useState)(!1),a=Object(C.a)(t,2),n=a[0],r=a[1],o=Object(c.useState)(!1),l=Object(C.a)(o,2),s=l[0],m=l[1],d=Object(c.useState)(!1),p=Object(C.a)(d,2),f=p[0],h=p[1],v=Object(I.d)(),E=Object(c.useContext)(le.a).confirm,b=Object(I.e)((function(e){return e.auth})),y=e.repository,g=e.itf,O=e.itfs,N=void 0===O?[]:O,j=e.mod,k=ke(),S={color:"#CC0000",fontWeight:"bold",fontSize:16,display:"inline",margin:"0 4px"};return 0===y.modules.length?i.a.createElement("div",{style:{height:600}},"\u8bf7\u5148\u6dfb\u52a0\u6a21\u5757"):i.a.createElement("article",{className:"InterfaceList"},y.canUserEdit?i.a.createElement("div",{className:"header"},i.a.createElement(M.a,{className:"newIntf",variant:"outlined",fullWidth:!0,color:"primary",onClick:function(){return r(!0)}},"\u65b0\u5efa\u63a5\u53e3"),i.a.createElement(oe,{title:"\u65b0\u5efa\u63a5\u53e3",repository:y,mod:j,open:n,onClose:function(){return r(!1)}}),i.a.createElement(ue.a,{fullWidth:!0,size:"medium"},i.a.createElement(M.a,{variant:"outlined",color:"primary",onClick:function(){return m(!0)}},"\u4fee\u6539\u6a21\u5757"),i.a.createElement(M.a,{variant:"outlined",color:"primary",onClick:function(){return h(!0)}},"\u79fb\u52a8/\u590d\u5236"),i.a.createElement(M.a,{variant:"outlined",color:"primary",onClick:function(t){t.preventDefault();var a=i.a.createElement("div",{style:{width:800}},i.a.createElement("div",null,i.a.createElement("div",{style:S},"\u6a21\u5757"),"\u88ab\u5220\u9664\u540e",i.a.createElement("div",{style:S},"\u4e0d\u53ef\u6062\u590d"),"\uff01\u5e76\u4e14\u4f1a\u5220\u9664",i.a.createElement("div",{style:S},"\u76f8\u5173\u7684\u63a5\u53e3"),"\uff01"),i.a.createElement("div",null,"\u786e\u8ba4\u7ee7\u7eed\u5220\u9664\u300e#$",j.id," $",j.name,"\u300f\u5417\uff1f"));E({title:"\u786e\u8ba4\u5220\u9664\u6a21\u5757",content:a}).then((function(){v(Object(L.d)(e.mod.id,(function(){}),y.id))}))}},"\u5220\u9664\u6a21\u5757")),s&&i.a.createElement(F,{title:"\u4fee\u6539\u6a21\u5757",module:j,repository:y,open:s,onClose:function(){return m(!1)}}),f&&i.a.createElement(ge,{title:"\u79fb\u52a8/\u590d\u5236\u6a21\u5757",mod:j,repository:y,open:f,onClose:function(){return h(!1)}})):null,N.length?i.a.createElement("div",{className:"scrollWrapper ".concat(k.interface)},i.a.createElement(u.b,null,i.a.createElement(u.h,{onChange:function(e,t){v(Object(X.s)(t.toArray(),j.id,(function(){})))},disabled:!y.canUserEdit},i.a.createElement("ul",{className:"body"},N.map((function(e){return i.a.createElement("li",{key:e.id,className:"".concat(e.id===g.id?k.interfaceActive:""," sortable ").concat(k.li),"data-id":e.id},i.a.createElement(je,{repository:y,mod:j,itf:e,active:e.id===g.id,auth:b}))})))))):i.a.createElement("div",{className:"alert alert-info"},"\u6682\u65e0\u63a5\u53e3\uff0c\u8bf7\u65b0\u5efa"))})),Ie=a(271),Se=a(787),we=a(198),Pe=a(784),Re=a(164),xe=Object(W.a)((function(){return Object(Ie.a)({root:{position:"relative",display:"inline"},buttonProgress:{color:Re.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})})),Te=i.a.forwardRef((function(e,t){var a=e.children,n=e.label,r=Object(we.a)(e,["children","label"]),o=xe(),l=e.disabled;return i.a.createElement("div",{className:o.root,ref:t},i.a.createElement(M.a,r,l?"\u5904\u7406\u4e2d...":n,a),l&&i.a.createElement(Pe.a,{size:24,className:o.buttonProgress}))})),De=a(747),Me=a.n(De),Ae=a(746),_e=a.n(Ae),Le=a(743),Ue=a.n(Le),qe=a(349),Be=a.n(qe),Fe=a(745),ze=a.n(Fe),We=a(785),He=a(663),Ye=a(665),Je=a(718),Ge=a(719),Qe=a(393),Xe=a(800),Ve=a(93),$e=a(68),Ke=a(154),Ze=a.n(Ke),et=function(e){return"".concat(Ze()(e).format("YYYY-MM-DD"))},tt=et,at=a(278);var nt=function(){return i.a.createElement("div",{style:{padding:16,fontSize:18}},"\u6682\u65e0\u6570\u636e")},rt=a(742),ot=a.n(rt),lt=Object(W.a)({list:{width:650,overflow:"auto",height:"calc(100% - 50px)"},fullList:{width:"auto"},pager:{height:50,marginBottom:12}}),ct=function(e){var t=e.row,a=Object(c.useState)(!1),n=Object(C.a)(a,2),r=n[0],o=n[1],l=Object(c.useState)(!1),s=Object(C.a)(l,2),m=s[0],u=s[1],d=t.changeLog.split(".|.").map((function(e){return e.split("@|@")})).reduceRight((function(e,t){return[].concat(Object(de.a)(e),Object(de.a)(t))}),[]).map((function(e){return"* ".concat(e)}));return d.length>5&&!r&&(d.length=5,m||u(!0)),i.a.createElement("div",null,i.a.createElement(at.a,null,d.join("\n")),m&&i.a.createElement(M.a,{color:"primary",variant:"outlined",onClick:function(){return o(!r)},size:"small",className:"mb1"},r?"\u6298\u53e0":"\u5c55\u5f00\u66f4\u591a"))},it={rows:[],count:0};var st=function(e){var t=e.entityId,a=e.entityType,n=e.open,r=e.onClose,o=lt(),l=Object(c.useState)(it),s=Object(C.a)(l,2),u=s[0],d=s[1],p=Object(c.useState)(10),f=Object(C.a)(p,2),h=f[0],v=f[1],E=Object(c.useState)(0),b=Object(C.a)(E,2),y=b[0],g=b[1];return Object(c.useEffect)((function(){return n&&$e.a.fetchHistoryLogs({entityId:t,entityType:a,limit:h,offset:y*h}).then((function(e){d(e)})),function(){d(it)}}),[t,a,n,h,y]),i.a.createElement(We.a,{open:n,onClose:r},0===u.rows.length&&i.a.createElement(nt,null),i.a.createElement(He.a,{className:o.list},u.rows.map((function(e){return i.a.createElement(Ye.a,{key:e.id},i.a.createElement(Je.a,{primary:i.a.createElement(ct,{row:e}),secondary:"".concat(tt(e.createdAt)," by ").concat(e.user.fullname)}),!e.jsonDataIsNull&&i.a.createElement(Ge.a,null,i.a.createElement(Qe.a,{edge:"end","aria-label":"download",onClick:function(){return window.open("".concat(m.c,"/interface/history/JSONData/").concat(e.id))}},i.a.createElement(ot.a,null))))}))),i.a.createElement(Xe.a,Object.assign({className:o.pager,rowsPerPageOptions:[10,25,50],component:"div",count:u.count,rowsPerPage:h,page:y,onChangePage:function(e,t){return g(t)},onChangeRowsPerPage:function(e){v(parseInt(e.target.value,10)),g(0)}},Ve.d)))},mt=a(744),ut=a.n(mt),dt=Object(W.a)((function(e){return Object(Ie.a)({button:{margin:e.spacing(1)},leftIcon:{marginRight:e.spacing(1)},rightIcon:{marginLeft:e.spacing(1)},iconSmall:{fontSize:20}})}));var pt=function(e){var t=e.editable,a=e.locker,n=e.repository,r=e.handleEditInterface,o=e.handleMoveInterface,l=e.handleSaveInterfaceAndProperties,s=e.handleUnlockInterface,u=e.itfId,d=Object(I.e)((function(e){return e.loading})),p=Object(c.useState)(!1),f=Object(C.a)(p,2),h=f[0],v=f[1],E=dt();return n.canUserEdit?t?i.a.createElement("div",{className:"InterfaceEditorToolbar"},i.a.createElement(Te,{className:E.button,onClick:l,variant:"contained",color:"primary",disabled:d,label:"\u4fdd\u5b58",size:"small"},i.a.createElement(Ue.a,{className:E.rightIcon})),i.a.createElement(M.a,{className:E.button,onClick:s,variant:"contained",size:"small"},"\u53d6\u6d88",i.a.createElement(Be.a,{className:E.rightIcon})),i.a.createElement("span",{className:"locker-warning hide"},"\u5df2\u7ecf\u9501\u5b9a\u5f53\u524d\u63a5\u53e3\uff01")):a?i.a.createElement("div",{className:"InterfaceEditorToolbar"},i.a.createElement("div",{className:"alert alert-danger"},"\u5f53\u524d\u63a5\u53e3\u5df2\u7ecf\u88ab ",i.a.createElement("span",{className:"nowrap"},a.fullname)," \u9501\u5b9a\uff01")):i.a.createElement("div",{className:"InterfaceEditorToolbar"},i.a.createElement(Se.a,{title:"\u5bfc\u51fa\u7684\u5907\u4efd\u6587\u4ef6\uff0c\u53ef\u4ee5\u5bfc\u5165\u5230\u5176\u5b83\u9879\u76ee\uff0c\u6216\u672c\u9879\u76ee"},i.a.createElement(M.a,{className:"".concat(E.button," guide-2"),variant:"contained",onClick:function(){return window.open("".concat(m.c,"/interface/backup/JSONData/").concat(u))},size:"small"},"\u5bfc\u51fa",i.a.createElement(ut.a,{className:E.rightIcon}))),i.a.createElement(Se.a,{title:"\u67e5\u770b\u8be5\u63a5\u53e3\u4e2d\u7684\u6240\u6709\u6539\u52a8\u5386\u53f2"},i.a.createElement(M.a,{className:"".concat(E.button," guide-2"),variant:"contained",onClick:function(){return v(!0)},size:"small"},"\u5386\u53f2",i.a.createElement(ze.a,{className:E.rightIcon}))),i.a.createElement(Se.a,{title:"\u79fb\u52a8\u6216\u590d\u5236\u8be5\u63a5\u53e3"},i.a.createElement(M.a,{className:E.button,onClick:o,variant:"contained",size:"small"},"\u79fb\u52a8",i.a.createElement(_e.a,{className:E.rightIcon}))),i.a.createElement(Se.a,{title:"\u70b9\u51fb\u8fdb\u5165\u7f16\u8f91\u6a21\u5f0f\uff0c\u5e76\u9501\u5b9a\u8be5\u63a5\u53e3"},i.a.createElement(Te,{className:E.button,onClick:r,variant:"contained",color:"primary",disabled:d,label:"\u7f16\u8f91",size:"small"},i.a.createElement(Me.a,{className:E.rightIcon}))),i.a.createElement(st,{open:h,onClose:function(){return v(!1)},entityId:e.itfId,entityType:Ve.b.INTERFACE})):null},ft=a(15),ht=a(293),vt=a.n(ht),Et=a(748);a(750);var bt,yt=a(29),gt=a(667);!function(e){e.FORM_DATA="FORM_DATA",e.FORM_URLENCODED="FORM_URLENCODED",e.RAW="RAW",e.BINARY="BINARY"}(bt||(bt={}));function Ot(e){switch(e){case bt.BINARY:return"Binary";case bt.FORM_DATA:return"FormData";case bt.FORM_URLENCODED:return"UrlEncoded";case bt.RAW:return"Raw";default:return"-"}}var Nt,jt=[{label:"form-data",value:bt.FORM_DATA},{label:"x-www-form-urlencoded",value:bt.FORM_URLENCODED},{label:"raw",value:bt.RAW},{label:"binary",value:bt.BINARY}];!function(e){e[e.QUERY=2]="QUERY",e[e.HEADER=1]="HEADER",e[e.BODY=3]="BODY",e[e.PRE_REQUEST_SCRIPT=4]="PRE_REQUEST_SCRIPT",e[e.TEST=5]="TEST"}(Nt||(Nt={}));var kt=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r,o,l,c;return Object(n.a)(this,a),(c=t.call(this,e)).handleDelete=function(e,t){e.preventDefault();window.confirm("\u63a5\u53e3\u88ab\u5220\u9664\u540e\u4e0d\u53ef\u6062\u590d\uff01\n\u786e\u8ba4\u7ee7\u7eed\u5220\u9664\u5417\uff1f")&&(0,c.context.onDeleteInterface)(t.id,(function(){var e=c.props,t=e.router,a=e.replace,n=Object(s.e)(t);a(c.props.active?n.removeSearch("itf").href():n.href())}))},c.handleUpdate=function(){},c.state={bodyOption:null!==(r=null===e||void 0===e||null===(o=e.itf)||void 0===o?void 0:o.bodyOption)&&void 0!==r?r:bt.FORM_DATA,posFilter:"POST"===(null===e||void 0===e||null===(l=e.itf)||void 0===l?void 0:l.method)?Nt.BODY:Nt.QUERY},c.changeMethod=c.changeMethod.bind(Object(f.a)(c)),c.changeHandler=c.changeHandler.bind(Object(f.a)(c)),c.switchBodyOption=c.switchBodyOption.bind(Object(f.a)(c)),c.switchPos=c.switchPos.bind(Object(f.a)(c)),c.copyModelName=c.copyModelName.bind(Object(f.a)(c)),e.stateChangeHandler&&e.stateChangeHandler(c.state),c}return Object(r.a)(a,[{key:"switchBodyOption",value:function(e){var t=this;this.setState({bodyOption:e},(function(){t.props.stateChangeHandler(t.state)}))}},{key:"switchPos",value:function(e){var t=this;return function(){t.setState({posFilter:e},(function(){t.props.stateChangeHandler(t.state)}))}}},{key:"changeMethod",value:function(e){this.setState({method:e})}},{key:"changeStatus",value:function(e){this.setState({status:e})}},{key:"changeHandler",value:function(e){this.setState(Object(ft.a)({},e.target.name,e.target.value))}},{key:"copyModelName",value:function(){var e=this,t=this.props.itf,a=function(e){var t=e.method.toLowerCase(),a=e.url,n=e.repositoryId,r=e.id,o=/^(?:https?:\/\/[^\/]+)?(\/?.+?\/?)(?:\.[^./]+)?$/.exec(a);if(!o)return{ok:!1,name:"",message:"\n  \u2718 \u60a8\u7684rap\u63a5\u53e3url\u8bbe\u7f6e\u683c\u5f0f\u4e0d\u6b63\u786e\uff0c\u53c2\u8003\u683c\u5f0f\uff1a/api/test.json (\u63a5\u53e3url:".concat(a,", \u9879\u76eeid:").concat(n,", \u63a5\u53e3id:").concat(r,")\n")};var l=o[1].split("/");return l.forEach((function(e,t){/\:id/.test(e)?l[t]="$id":/[\[\]\{\}]/.test(e)&&(l[t]="$regx")})),""===l[0].trim()&&l.shift(),l.push(t),{ok:!0,name:l.join("_"),message:""}}(void 0===t?{}:t);if(a.ok){var n=a.name;vt()(n).then((function(){e.props.showMessage("\u6210\u529f\u590d\u5236 ".concat(n," \u5230\u526a\u8d34\u677f"),yt.a.SUCCESS)})).catch((function(){e.props.showMessage("\u590d\u5236\u5931\u8d25",yt.a.ERROR)}))}else this.props.showMessage("\u590d\u5236\u5931\u8d25: ".concat(a.message),yt.a.ERROR)}},{key:"render",value:function(){var e,t=this,a=this.props,n=a.repository,r=void 0===n?{}:n,o=a.itf,l=void 0===o?{}:o,c=a.editable,s=a.handleChangeInterface,d=this.state.posFilter,p={COPY_MODEL_NAME:this.copyModelName};return l.id?i.a.createElement("div",{className:"InterfaceSummary"},i.a.createElement(Et.GlobalHotKeys,{keyMap:{COPY_MODEL_NAME:["ctrl+alt+c"]},handlers:p}),!c&&i.a.createElement("div",{className:"header"},i.a.createElement(u.a,{text:l.name},i.a.createElement("span",{className:"title"},l.name))),i.a.createElement("ul",{className:"summary"},c?i.a.createElement("div",{style:{maxWidth:600}},i.a.createElement("div",null,i.a.createElement(v.a,{style:{marginTop:0},id:"name",label:"\u540d\u79f0",value:l.name||"",fullWidth:!0,autoComplete:"off",onChange:function(e){s({name:e.target.value})},margin:"normal"})),i.a.createElement("div",null,i.a.createElement(v.a,{id:"url",label:"\u5730\u5740",value:l.url||"",fullWidth:!0,autoComplete:"off",onChange:function(e){s({url:e.target.value})},margin:"normal"})),i.a.createElement("div",null,i.a.createElement("div",{style:{width:90,display:"inline-block"}},i.a.createElement($.a,{shrink:!0,htmlFor:"method-label-placeholder"}," \u7c7b\u578b "),i.a.createElement(K.a,{value:l.method,input:i.a.createElement(gt.a,{name:"method",id:"method-label-placeholder"}),onChange:function(e){s({method:e.target.value})},displayEmpty:!0,name:"method"},ee.map((function(e){return i.a.createElement(Z.a,{key:e,value:e},e)})))),i.a.createElement("div",{style:{width:120,display:"inline-block"}},i.a.createElement($.a,{shrink:!0,htmlFor:"status-label-placeholder",style:{width:100}}," \u72b6\u6001\u7801 "),i.a.createElement(K.a,{value:l.status,input:i.a.createElement(gt.a,{name:"status",id:"status-label-placeholder"}),onChange:function(e){s({status:e.target.value})},displayEmpty:!0,name:"status"},te.map((function(e){return i.a.createElement(Z.a,{key:e,value:e},e)}))))),i.a.createElement(v.a,{id:"description",label:"\u63cf\u8ff0\uff08\u53ef\u591a\u884c, \u652f\u6301Markdown\uff09",value:l.description||"",fullWidth:!0,multiline:!0,autoComplete:"off",rowsMax:8,onChange:function(e){s({description:e.target.value})},margin:"normal"})):i.a.createElement(i.a.Fragment,null,i.a.createElement("li",null,i.a.createElement("span",{className:"mr5"},i.a.createElement("span",{className:"label"},"\u63a5\u53e3ID\uff1a"),l.id)),i.a.createElement("li",null,i.a.createElement(u.a,{text:l.url,type:"right"},i.a.createElement("span",{className:"mr5"},i.a.createElement("span",{className:"label"},"\u5730\u5740\uff1a"),i.a.createElement("a",{href:"".concat(m.c,"/app/mock/").concat(r.id).concat((e=l.url||"",e instanceof RegExp?e:e?(e.indexOf("http://")>-1?e=e.substring(e.indexOf("/",7)+1):e.indexOf("https://")>-1&&(e=e.substring(e.indexOf("/",8)+1)),"/"!==e.charAt(0)&&(e="/"+e),e):"")),target:"_blank",rel:"noopener noreferrer"},l.url)))),i.a.createElement("li",null,i.a.createElement("span",null,i.a.createElement("span",{className:"label"},"\u7c7b\u578b\uff1a"),i.a.createElement("span",null,l.method))),i.a.createElement("li",null,i.a.createElement("span",null,i.a.createElement("span",{className:"label"},"\u72b6\u6001\u7801\uff1a"),i.a.createElement("span",null,l.status))))),l.description&&i.a.createElement(u.a,{text:l.description},i.a.createElement(at.a,null,l.description||"")),c&&i.a.createElement("ul",{className:"nav nav-tabs",role:"tablist"},i.a.createElement("li",{className:"nav-item",onClick:this.switchPos(Nt.HEADER)},i.a.createElement("button",{className:"nav-link ".concat(d===Nt.HEADER?"active":""),role:"tab","data-toggle":"tab"},"Headers")),i.a.createElement("li",{className:"nav-item",onClick:this.switchPos(Nt.QUERY)},i.a.createElement("button",{className:"nav-link ".concat(d===Nt.QUERY?"active":""),role:"tab","data-toggle":"tab"},"Query Params")),i.a.createElement("li",{className:"nav-item",onClick:this.switchPos(Nt.BODY)},i.a.createElement("button",{className:"nav-link ".concat(d===Nt.BODY?"active":""),role:"tab","data-toggle":"tab"},"Body Params"))),c&&d===Nt.BODY?i.a.createElement(V.a,{component:"fieldset"},i.a.createElement(ve.a,{"aria-label":"body type",name:"body-type",value:this.state.bodyOption,onChange:function(e){return t.switchBodyOption(e.target.value)},row:!0},jt.map((function(e){return i.a.createElement(Ee.a,{key:e.value,value:e.value,control:i.a.createElement(be.a,null),label:e.label})})))):null):null}}]),a}(c.Component);kt.contextTypes={onDeleteInterface:s.c.func.isRequired};var Ct={replace:s.n,showMessage:yt.d},It=Object(I.c)((function(){return{}}),Ct)(kt),St=a(2),wt=a.n(St),Pt=(a(274),a(277)),Rt=function(){return{scope:"response",name:"",type:"String",value:"",description:"",parentId:-1,interfaceId:void 0,moduleId:void 0,repositoryId:void 0}},xt=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).handleSubmit=function(e){e.preventDefault();var t=r.props,a=t.auth,n=t.repository,o=t.mod,l=t.interfaceId,c=t.scope,i=t.parent,s=void 0===i?{id:-1}:i;(0,r.context.handleAddMemoryProperty)(Object.assign({},r.state,{creatorId:a.id,repositoryId:n.id,moduleId:o.id,interfaceId:l,scope:c,parentId:s.id}),(function(){var e=r.context.rmodal;e&&e.resolve()}))},r.state=Rt(),r}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.context.rmodal;return i.a.createElement("section",null,i.a.createElement("div",{className:"rmodal-header"},i.a.createElement("span",{className:"rmodal-title"},this.props.title)),i.a.createElement("form",{className:"form-horizontal w600",onSubmit:this.handleSubmit},i.a.createElement("div",{className:"rmodal-body"},i.a.createElement("div",{className:"form-group row",style:{}},i.a.createElement("label",{className:"col-sm-2 control-label"},"\u540d\u79f0\uff1a"),i.a.createElement("div",{className:"col-sm-10"},i.a.createElement("input",{name:"name",tabIndex:1,value:this.state.name,onChange:function(t){return e.setState({name:t.target.value})},className:"form-control",placeholder:"Name",spellCheck:!1,autoFocus:!0,required:!0}))),i.a.createElement("div",{className:"form-group row"},i.a.createElement("label",{className:"col-sm-2 control-label"},"\u7c7b\u578b\uff1a"),i.a.createElement("div",{className:"col-sm-10"},i.a.createElement("select",{name:"type",tabIndex:2,value:this.state.type,onChange:function(t){var a=t.target.value;"Null"===a&&e.setState({value:""}),e.setState({type:a})},className:"form-control"},Ve.c.map((function(e){return i.a.createElement("option",{key:e,value:e},e)}))))),i.a.createElement("div",{className:"form-group row"},i.a.createElement("label",{className:"col-sm-2 control-label"},"\u751f\u6210\u89c4\u5219\uff1a"),i.a.createElement("div",{className:"col-sm-10"},i.a.createElement("input",{name:"rule",tabIndex:3,value:this.state.rule,onChange:function(t){return e.setState({rule:t.target.value})},className:"form-control",placeholder:"Rule",spellCheck:!1}))),i.a.createElement("div",{className:"form-group row"},i.a.createElement("label",{className:"col-sm-2 control-label"},"\u521d\u59cb\u503c\uff1a"),i.a.createElement("div",{className:"col-sm-10"},i.a.createElement("input",{name:"value",tabIndex:4,value:this.state.value,onChange:function(t){return e.setState({value:t.target.value})},className:"form-control",placeholder:"Value",spellCheck:!1}))),i.a.createElement("div",{className:"form-group row"},i.a.createElement("label",{className:"col-sm-2 control-label"},"\u7b80\u4ecb\uff1a"),i.a.createElement("div",{className:"col-sm-10"},i.a.createElement(Pt.a,{tabIndex:5,name:"description",value:this.state.description,onChange:function(t){return e.setState({description:t.target.value})},className:"form-control",placeholder:"Description",spellCheck:!1,rows:"5"})))),i.a.createElement("div",{className:"rmodal-footer"},i.a.createElement("div",{className:"form-group row mb0"},i.a.createElement("label",{className:"col-sm-2 control-label"}),i.a.createElement("div",{className:"col-sm-10"},i.a.createElement(M.a,{type:"submit",variant:"contained",color:"primary",style:{marginRight:8}},"\u63d0\u4ea4"),i.a.createElement(M.a,{onClick:function(){return t.close()}},"\u53d6\u6d88"))))))}},{key:"componentDidUpdate",value:function(){this.context.rmodal.reposition()}}]),a}(c.Component);xt.contextTypes={rmodal:wt.a.instanceOf(c.Component),handleAddMemoryProperty:wt.a.func.isRequired};var Tt=Object(I.c)((function(e){return{auth:e.auth}}),{})(xt),Dt=a(71),Mt=a(736),At=a.n(Mt),_t=function(){return{}};function Lt(e){return["number","null","undefined","boolean","string"].indexOf(e.toLowerCase())>-1}var Ut=function(e){return e.every((function(t){return"number"===typeof t&&function(t,a){return 0===a||t-e[a-1]===1}}))};function qt(e){if(e&&e.length){if(1===e.length)return e[0].properties||(e[0].properties=[]),e[0];var t=e[0];t.properties||(t.properties=[]);for(var a=t.properties,n=1;n<e.length;++n){var r=e[n];if(r.properties&&r.properties.length){var o,l=Object(ce.a)(r.properties);try{var c=function(){var e=o.value;a.find((function(t){return t.name===e.name}))||a.push(e)};for(l.s();!(o=l.n()).done;)c()}catch(i){l.e(i)}finally{l.f()}}}return t}return{properties:[]}}var Bt=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).$rcm=void 0,r.handleBeautify=function(e){if(e.preventDefault(),r.$rcm){var t=At.a.parse(r.state.result),a=JSON.stringify(t,null,2);r.$rcm.cm.setValue(a)}},r.handleJSONSchema=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:-1},a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(e){var o=r.props,l=o.auth,c=o.repository,i=o.mod,m=o.interfaceId,u=o.scope,d=o.pos,p=n instanceof Array&&n.length>0;"__mockjs_length_*#06#"===e.name&&(e.name="length");var f=e.type[0].toUpperCase()+e.type.slice(1),h="";"Array"===f&&e.items&&e.items.length>1&&(h=e.items.length);var v=/Array|Object/.test(f)?"":e.template;if(e.items&&e.items.length){var E=e.items[0].type;Lt(E)&&(v=JSON.stringify(e.template),h="")}else if(p&&Lt(f)){var b=n.map((function(e){return e&&e.template}));s.h.uniq(b).length>1&&(Ut(b)?(v=b[0],h="+1"):(v=JSON.stringify(b),f="Array",h="+1"))}var y=Object.assign({name:e.name,type:f,rule:h,value:v,description:"",pos:d},{creator:l.id,repositoryId:c.id,moduleId:i.id,interfaceId:m,scope:u,parentId:t.id},{memory:!0,id:s.h.uniqueId("memory-")});a.push(y),e.properties&&e.properties.forEach((function(e){var t=p?n.map((function(t){return t&&(t.properties.find((function(t){return t.name===e.name}))||null)})):void 0;r.handleJSONSchema(e,y,a,t)})),qt(e.items).properties.forEach((function(t){var n=e.items.map((function(e){return e.properties.find((function(e){return e.name===t.name}))||null}));r.handleJSONSchema(t,y,a,n)}))}},r.handleSubmit=function(e){e.preventDefault();var t=At.a.parse(r.state.result);r.state.result.indexOf("length")>-1&&function e(t){for(var a in t)if(t[a]&&"object"===typeof t[a])e(t[a]);else if("length"===a){var n=t[a];delete t[a],t["__mockjs_length_*#06#"]=n}}(t),t instanceof Array&&(t={__root__:t});var a=s.b.toJSONSchema(t),n=[];a.properties&&a.properties.forEach((function(e){return r.handleJSONSchema(e,void 0,n)})),(0,r.context.handleAddMemoryProperties)(n,(function(){var e=r.context.rmodal;e&&e.resolve()}))},r.state={result:JSON.stringify(_t(),null,2)},r}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.context.rmodal;return i.a.createElement("section",{className:"Importer"},i.a.createElement("div",{className:"rmodal-header"},i.a.createElement("span",{className:"rmodal-title"},this.props.title),i.a.createElement(s.a,{to:"",onClick:function(t){return e.handleBeautify(t)}},"\u683c\u5f0f\u5316")),i.a.createElement("form",{className:"form-horizontal w600",onSubmit:this.handleSubmit},i.a.createElement("div",{className:"rmodal-body"},i.a.createElement("div",{className:"form-group"},i.a.createElement(u.f,{value:this.state.result,onChange:function(t){return e.setState({result:t})},ref:function(t){e.$rcm=t}}))),i.a.createElement("div",{className:"rmodal-footer"},i.a.createElement("div",{className:"form-group mb0"},i.a.createElement(M.a,{type:"submit",style:{marginRight:8},variant:"contained",color:"primary"},"\u63d0\u4ea4"),i.a.createElement(M.a,{onClick:function(){return t.close()}}," \u53d6\u6d88 ")))))}},{key:"componentDidUpdate",value:function(){this.context.rmodal.reposition()}}]),a}(c.Component);Bt.contextTypes={rmodal:s.c.object.isRequired,handleAddMemoryProperties:s.c.func.isRequired};var Ft={onAddProperty:Dt.a},zt=Object(s.i)((function(e){return{auth:e.auth}}),Ft)(Bt),Wt=/(.+)\|(?:\+(\d+)|([\+\-]?\d+-?[\+\-]?\d*)?(?:\.(\d+-?\d*))?)/,Ht=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).remock=function(t){t.preventDefault();var a=t.currentTarget.firstChild;a.classList.add("animated"),a.classList.add("rotateIn"),e.forceUpdate()},e.removeAnimateClass=function(e){var t=e.currentTarget;t.classList.remove("animated"),t.classList.remove("rotateIn")},e}return Object(r.a)(a,[{key:"render",value:function(){var e,t,a,n,r,o=this,l=this.props,c=l.label,d=l.scope,f=l.properties,h=l.interfaceId;try{t={request:f.map((function(e){return Object(p.a)({},e)})).filter((function(e){return"request"===e.scope})),response:f.map((function(e){return Object(p.a)({},e)})).filter((function(e){return"response"===e.scope}))},e={request:u.k.treeToJson(u.k.arrayToTree(t.request)),response:u.k.treeToJson(u.k.arrayToTree(t.response))},n={request:Object.keys(e.request).map((function(e){return e.replace(Wt,"$1")})),response:Object.keys(e.response).map((function(e){return e.replace(Wt,"$1")}))},r=s.h.difference(n.request,n.response),(a={request:s.b.mock(e.request)}).response=s.b.mock(Object.assign({},s.h.pick(a.request,r),e.response)),a.response=s.h.pick(a.response,n.response);var v=e[d],E=a[d];E.__root__&&(E=E.__root__);var b=Object.keys(E);1===b.length&&"__root__"===b[0]&&(E=E.__root__);var y,g=s.b.valid.Assert,O=s.b.valid(v,E),N=Object(ce.a)(O);try{for(N.s();!(y=N.n()).done;){var j=y.value;console.warn(g.message(j))}}catch(k){N.e(k)}finally{N.f()}return i.a.createElement("div",{className:"Previewer"},i.a.createElement("div",{className:"result-template"},i.a.createElement("div",{className:"header"},i.a.createElement("span",{className:"title"},c,"\u6a21\u677f"),"response"===d?i.a.createElement("a",{href:"".concat(m.c,"/app/mock/template/").concat(h),target:"_blank",rel:"noopener noreferrer"},i.a.createElement(z.j,{className:"fontsize-14"})):null),i.a.createElement("pre",{className:"body"},JSON.stringify(v,(function(e,t){return"function"===typeof t||void 0!==t&&null!==t&&t.exec?t.toString():t}),2))),i.a.createElement("div",{className:"result-mocked"},i.a.createElement("div",{className:"header"},i.a.createElement("span",{className:"title"},c,"\u6570\u636e"),"response"===d?i.a.createElement("a",{href:"".concat(m.c,"/app/mock/data/").concat(h),target:"_blank",rel:"noopener noreferrer"},i.a.createElement(z.j,{className:"mr6 fontsize-14"})):null,i.a.createElement(s.a,{to:"",onClick:function(e){return o.remock(e)}},i.a.createElement(z.w,{className:"mr6 fontsize-14",onAnimationEnd:function(e){return o.removeAnimateClass(e)}}))),i.a.createElement("pre",{className:"body"},JSON.stringify(E,null,2))),"response"===d?i.a.createElement("div",{className:"result-valid col-12"},O.length?i.a.createElement("span",null,i.a.createElement(z.d,{className:"mr6 fontsize-20"}),"\u6a21\u677f\u4e0e\u6570\u636e\u4e0d\u5339\u914d"):i.a.createElement("span",null,i.a.createElement(z.c,{className:"mr6 fontsize-20"}),"\u6a21\u677f\u4e0e\u6570\u636e\u5339\u914d \u221a")):null)}catch(C){a&&(a.response="\u65e0\u6cd5\u9884\u89c8Mock\u6570\u636e\uff0c\u56e0\u4e3a\u60a8\u7f16\u5199\u89c4\u5219\u5bfc\u81f4\u5982\u4e0b\u9519\u8bef\uff1a".concat(C.message))}return i.a.createElement("div",null,"\u53d1\u751f\u9519\u8bef...")}}]),a}(c.Component),Yt=(a(751),a(725)),Jt=a(139),Gt=a.n(Jt);var Qt=function(){return{scope:"response",name:"",type:"String",value:"",description:"",parentId:-1,interfaceId:void 0,moduleId:void 0,repositoryId:void 0}};function Xt(e){return["Object","Null"].indexOf(e)>-1}var Vt=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.editable,a=e.handleClickCreatePropertyButton;return i.a.createElement("div",{className:"SortableTreeTableHeader"},i.a.createElement("div",{className:"flex-row"},i.a.createElement("div",{className:"th operations"},i.a.createElement(s.a,{to:"",onClick:function(e){e.preventDefault(),a()}},t&&i.a.createElement(z.r,{className:"fontsize-14 color-6"}))),i.a.createElement("div",{className:"th name"},"\u540d\u79f0"),i.a.createElement("div",{className:"th type"},"\u5fc5\u9009"),i.a.createElement("div",{className:"th type"},"\u7c7b\u578b"),i.a.createElement("div",{className:"th rule"},"\u751f\u6210\u89c4\u5219",i.a.createElement("a",{href:"https://github.com/nuysoft/Mock/wiki/Syntax-Specification",rel:"noopener noreferrer",className:"helper",target:"_blank"},i.a.createElement(z.s,null))),i.a.createElement("div",{className:"th value"},"\u521d\u59cb\u503c"),i.a.createElement("div",{className:"th desc"},"\u7b80\u4ecb")))}}]),a}(c.Component),$t=function(e){var t,a=e.pos,n=e.itf;return 1===a?i.a.createElement("span",{className:"badge badge-danger"},"HEAD"):3===a?i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{className:"badge badge-primary"},"BODY"),(null===n||void 0===n?void 0:n.bodyOption)&&i.a.createElement("span",{style:{color:"#CC0000"}},(t=n.bodyOption)===bt.FORM_URLENCODED?"x-www-form-urlencoded":t===bt.FORM_DATA?"form-data":t===bt.RAW?"raw":t===bt.BINARY?"binary":"-")):i.a.createElement("span",{className:"badge badge-secondary"},"QUERY")},Kt=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).focusNameInput=void 0,r.state={property:{children:[]},childrenAdded:!1,childrenExpandingIdList:[],interfaceId:-1},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){this.focusInput()}},{key:"componentDidUpdate",value:function(){this.focusInput()}},{key:"focusInput",value:function(){this.focusNameInput&&this.state.childrenAdded&&(this.focusNameInput.focus(),function(e){for(var t=e.offsetTop,a=e.offsetLeft,n=e.offsetWidth,r=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,a+=e.offsetLeft;return t>=window.pageYOffset&&a>=window.pageXOffset&&t+r<=window.pageYOffset+window.innerHeight&&a+n<=window.pageXOffset+window.innerWidth}(this.focusNameInput)||this.focusNameInput.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.property,r=t.isExpanding,o=t.interfaceId,l=t.editable,c=t.handleClickCreateChildPropertyButton,m=t.highlightId,d=t.handleDeleteMemoryProperty,f=t.handleChangeProperty,h=t.handleChangePropertyField,v=t.handleSortProperties,E=t.bodyOption,b=t.itf;return r&&i.a.createElement(u.h,{group:n.depth,handle:".SortableTreeTableRow",disabled:!l,onChange:v},i.a.createElement("div",{className:"RSortableWrapper depth".concat(n.depth)},n.children.sort((function(e,t){return e.priority-t.priority})).map((function(t){var n=e.state.childrenExpandingIdList.includes(t.id);return i.a.createElement("div",{key:t.id,className:"SortableTreeTableRow","data-id":t.id},i.a.createElement("div",{className:Gt()("flex-row",{highlight:t.id===m})},i.a.createElement("div",{className:"td operations nowrap"},("Object"===t.type||"Array"===t.type)&&t.children&&t.children.length?i.a.createElement(s.a,{to:"",onClick:function(a){a.preventDefault(),e.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{childrenExpandingIdList:n?e.childrenExpandingIdList.filter((function(e){return e!==t.id})):[].concat(Object(de.a)(e.childrenExpandingIdList),[t.id])})}))}},n?i.a.createElement(z.e,{className:"fontsize-14 color-6"}):i.a.createElement(z.f,{className:"fontsize-14 color-6"})):null,l&&i.a.createElement(i.a.Fragment,null,"Object"===t.type||"Array"===t.type?i.a.createElement(s.a,{to:"",onClick:function(a){a.preventDefault(),c(t),e.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{childrenExpandingIdList:he.a.uniq([].concat(Object(de.a)(e.childrenExpandingIdList),[t.id]))})}))}},i.a.createElement(z.r,{className:"fontsize-14 color-6"})):null,i.a.createElement(s.a,{to:"",onClick:function(e){return d(e,t)}},i.a.createElement(z.x,{className:"fontsize-14 color-6"})))),i.a.createElement("div",{className:"td payload name depth-".concat(t.depth," nowrap")},l?i.a.createElement("input",{ref:function(a){t.id===m&&(e.focusNameInput=a)},value:t.name,onChange:function(e){h(t.id,"name",e.target.value)},onKeyPress:function(e){!0===e.ctrlKey&&e.charCode},className:"form-control editable",spellCheck:!1,placeholder:""}):i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{text:t.name,type:"right"},i.a.createElement("span",{className:"name-wrapper nowrap"},t.pos===Nt.BODY&&"request"===t.scope?i.a.createElement(Se.a,{title:Ot(null!==E&&void 0!==E?E:bt.RAW)},i.a.createElement("span",null,t.name)):t.name)),"request"===t.scope&&0===t.depth?i.a.createElement("div",{style:{margin:"1px 0 0 3px"}},i.a.createElement($t,{pos:t.pos,itf:b})):null)),i.a.createElement("div",{className:"td payload required type depth-".concat(t.depth," nowrap")},i.a.createElement(Yt.a,{checked:!!t.required,disabled:!l,onChange:function(e){return h(t.id,"required",e.target.checked)},color:"primary",inputProps:{"aria-label":"\u5fc5\u9009"}})),i.a.createElement("div",{className:"td payload type"},l?i.a.createElement("select",{value:t.type,onChange:function(e){var a=e.target.value;Xt(a)?f(t.id,{value:"",type:a}):f(t.id,{type:a})},className:"form-control editable"},Ve.c.map((function(e){return i.a.createElement("option",{key:e,value:e},e)}))):i.a.createElement(u.a,{text:t.type},i.a.createElement("span",{className:"nowrap"},t.type))),i.a.createElement("div",{className:"td payload rule nowrap"},l?i.a.createElement("input",{value:t.rule||"",onChange:function(e){return h(t.id,"rule",e.target.value)},className:"form-control editable",spellCheck:!1,placeholder:""}):i.a.createElement("span",{className:"nowrap"},t.rule)),i.a.createElement("div",{className:"td payload value"},l?i.a.createElement(u.i,{value:t.value||"",onChange:function(e){return h(t.id,"value",e.target.value)},disabled:Xt(t.type)&&!t.value,rows:"1",className:"form-control editable",spellCheck:!1,placeholder:""}):i.a.createElement(u.a,{text:t.value},i.a.createElement("span",{className:"value-container"},function(e){if("Array"!==e.type&&"Object"!==e.type&&"String"!==e.type||!e.value)return e.value||"";try{return JSON.stringify(At.a.parse(e.value),void 0,2)}catch(t){return e.value||""}}(t)))),i.a.createElement("div",{className:"td payload desc"},l?i.a.createElement(u.i,{value:t.description||"",onChange:function(e){return h(t.id,"description",e.target.value)},rows:"1",className:"form-control editable",spellCheck:!1,placeholder:""}):i.a.createElement(u.a,{text:t.description},i.a.createElement("span",null,t.description)))),t.children&&t.children.length?i.a.createElement(a,{editable:l,highlightId:m,interfaceId:o,handleClickCreateChildPropertyButton:c,handleDeleteMemoryProperty:d,handleChangeProperty:f,handleChangePropertyField:h,handleSortProperties:v,property:t,bodyOption:E,isExpanding:n,itf:b}):null)}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{interfaceId:e.interfaceId,property:e.property,childrenAdded:e.property.children.length>t.property.children.length,childrenExpandingIdList:e.interfaceId!==t.interfaceId?e.property.children.map((function(e){return e.id})):t.childrenExpandingIdList}}}]),a}(c.Component);Kt.displayName="SortableTreeTableRow",Kt.whyDidYouRender=!0;var Zt=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.root,a=e.editable,n=e.highlightId,r=e.interfaceId,o=e.handleClickCreateChildPropertyButton,l=e.handleDeleteMemoryProperty,c=e.handleChangeProperty,s=e.handleChangePropertyField,m=e.handleSortProperties,u=e.bodyOption,d=e.itf;return i.a.createElement("div",{className:"SortableTreeTable ".concat(a?"editable":"")},i.a.createElement(Vt,this.props),i.a.createElement(Kt,{editable:a,highlightId:n,handleClickCreateChildPropertyButton:o,handleDeleteMemoryProperty:l,handleChangeProperty:c,handleChangePropertyField:s,handleSortProperties:m,interfaceId:r,property:t,isExpanding:!0,bodyOption:u,itf:d}))}}]),a}(c.Component),ea=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).handleClickCreatePropertyButton=function(){r.handleClickCreateChildPropertyButton()},r.handleClickCreateChildPropertyButton=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:-1},t=r.context.handleAddMemoryProperty,a=r.props,n=a.auth,o=a.scope,l=a.repository,c=void 0===l?{}:l,i=a.mod,s=void 0===i?{}:i,m=a.interfaceId,u=he.a.uniqueId("memory-"),d=Object(p.a)(Object(p.a)({},Qt()),{},{id:u,creatorId:n.id,repositoryId:c.id,moduleId:s.id,interfaceId:m,scope:o,parentId:e.id,pos:"request"===o?r.props.posFilter:void 0});r.setState({highlightId:u}),t(d,(function(){}))},r.handleClickImporterButton=function(){r.setState({importer:!0})},r.handleClickPreviewerButton=function(){r.setState({previewer:!r.state.previewer})},r.handleChangePropertyField=function(e,t,a){var n=r.props.handleChangeProperty,o=r.props.properties.find((function(t){return t.id===e}));n(Object(p.a)(Object(p.a)({},o),{},Object(ft.a)({},t,a)))},r.handleChangeProperty=function(e,t){var a=r.props.handleChangeProperty,n=r.props.properties.find((function(t){return t.id===e}));a(Object(p.a)(Object(p.a)({},n),t))},r.handleCreatePropertySucceeded=function(){},r.handleDeleteMemoryProperty=function(e,t){e.preventDefault(),(0,r.props.handleDeleteMemoryProperty)(t)},r.handleSortProperties=function(e,t){var a=r.props.properties;t.toArray().forEach((function(e,t){a.find((function(t){return t.id===e||t.id===+e})).priority=t+1}))},r.state={highlightId:void 0,createProperty:!1,createChildProperty:!1,previewer:"response"===e.scope,importer:!1},r}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.title,n=t.label,r=t.scope,o=t.properties,l=void 0===o?[]:o,c=t.repository,s=void 0===c?{}:c,m=t.mod,d=void 0===m?{}:m,f=t.interfaceId,h=t.bodyOption,v=t.posFilter,E=t.itf;if(!f)return null;var b=this.props.editable,y=l.map((function(e){return Object(p.a)({},e)})).filter((function(e){return e.scope===r}));return"request"===r&&b&&(y=y.filter((function(e){return e.pos===v}))),i.a.createElement("section",{className:"PropertyList"},i.a.createElement("div",{className:"header clearfix"},i.a.createElement("span",{className:"title"},a||"".concat(n,"\u5c5e\u6027")),i.a.createElement("div",{className:"toolbar"},i.a.createElement(ue.a,{size:"small",color:"primary"},b&&[i.a.createElement(M.a,{key:1,onClick:this.handleClickCreatePropertyButton},"\u65b0\u5efa"),i.a.createElement(M.a,{key:2,onClick:this.handleClickImporterButton},"\u5bfc\u5165")],i.a.createElement(M.a,{className:this.state.previewer?"checked-button":"",onClick:this.handleClickPreviewerButton},"\u9884\u89c8")))),i.a.createElement("div",{className:"body"},i.a.createElement(Zt,{root:u.k.arrayToTree(y),bodyOption:h,editable:b,highlightId:this.state.highlightId,interfaceId:f,handleClickCreateChildPropertyButton:this.handleClickCreateChildPropertyButton,handleDeleteMemoryProperty:this.handleDeleteMemoryProperty,handleChangePropertyField:this.handleChangePropertyField,handleChangeProperty:this.handleChangeProperty,handleSortProperties:this.handleSortProperties,handleClickCreatePropertyButton:this.handleClickCreatePropertyButton,itf:E})),i.a.createElement("div",{className:"footer"},this.state.previewer&&i.a.createElement(Ht,{scope:r,label:n,properties:l,interfaceId:f})),i.a.createElement(u.g,{when:this.state.createProperty,onClose:function(){return e.setState({createProperty:!1})},onResolve:this.handleCreatePropertySucceeded},i.a.createElement(Tt,{title:"\u65b0\u5efa".concat(n,"\u5c5e\u6027"),scope:r,repository:s,mod:d,interfaceId:f})),i.a.createElement(u.g,{when:!!this.state.createChildProperty,onClose:function(){return e.setState({createChildProperty:!1})},onResolve:this.handleCreatePropertySucceeded},i.a.createElement(Tt,{title:"\u65b0\u5efa".concat(n,"\u5c5e\u6027"),scope:r,repository:s,mod:d,interfaceId:f,parent:this.state.createChildProperty})),i.a.createElement(u.g,{when:this.state.importer,onClose:function(){return e.setState({importer:!1})},onResolve:this.handleCreatePropertySucceeded},i.a.createElement(zt,{title:"\u5bfc\u5165".concat(n,"\u5c5e\u6027"),repository:s,mod:d,interfaceId:f,scope:r,pos:v})))}}]),a}(c.PureComponent);ea.contextTypes={handleAddMemoryProperty:s.c.func.isRequired};var ta=ea,aa=a(42),na=Object(W.a)((function(e){var t=e.spacing;return{root:{},appBar:{position:"relative"},title:{marginLeft:t(2),flex:1},preview:{marginTop:t(1)},form:{minWidth:500},formTitle:{color:"rgba(0, 0, 0, 0.54)",fontSize:9},formItem:{marginBottom:t(1)},ctl:{marginTop:t(2)},select:{width:t(20)}}}));function ra(e){var t=e.repository,a=e.title,n=e.itfId,r=e.onClose,o=e.open,l=e.mod,s=na(),m=Object(c.useState)(t.id),u=Object(C.a)(m,2),d=u[0],p=u[1],f=Object(c.useState)(l.id),h=Object(C.a)(f,2),v=h[0],E=h[1],b=Object(c.useState)(1),y=Object(C.a)(b,2),g=y[0],O=y[1],N=Object(c.useState)(t.modules),j=Object(C.a)(N,2),k=j[0],S=j[1],w=Object(I.d)(),P=Object(I.e)((function(e){return he.a.uniqBy([].concat(Object(de.a)(e.ownedRepositories.data),Object(de.a)(e.joinedRepositories.data)),"id")}));Object(c.useEffect)((function(){P.length||(w(Object(pe.k)()),w(Object(pe.n)()))}),[w,P.length]);return i.a.createElement(x.a,{open:o,onClose:function(e,t){return"backdropClick"!==t&&r()}},i.a.createElement(T.a,null,a),i.a.createElement(D.a,{dividers:!0},i.a.createElement("form",{className:s.form,onSubmit:function(e){e.preventDefault();var t={modId:v,op:g,itfId:n,repositoryId:d};w(Object(X.p)(t,(function(){r()})))}},i.a.createElement("div",{className:"rmodal-body"},i.a.createElement("div",{className:s.formItem},i.a.createElement("div",{className:s.formTitle},"\u9009\u62e9\u76ee\u6807\u4ed3\u5e93\uff1a"),i.a.createElement(V.a,null,i.a.createElement(K.a,{className:s.select,onChange:function(e){var t=e.target.value;p(t),aa.a.fetchModuleList({repositoryId:t}).then((function(e){S(e),E(e[0]&&e[0].id)}))},value:d,fullWidth:!0},P.map((function(e){return i.a.createElement(Z.a,{key:e.id,value:e.id},e.name)}))))),i.a.createElement("div",{className:s.formItem},i.a.createElement("div",{className:s.formTitle},"\u9009\u62e9\u76ee\u6807\u6a21\u5757\uff1a"),i.a.createElement(V.a,null,i.a.createElement(K.a,{className:s.select,onChange:function(e){return E(+e.target.value)},value:v,fullWidth:!0},k.map((function(e){return i.a.createElement(Z.a,{key:e.id,value:e.id},e.name)}))))),i.a.createElement("div",{className:s.formItem},i.a.createElement("div",{className:s.formTitle},"\u64cd\u4f5c\u7c7b\u578b\uff1a"),i.a.createElement(ve.a,{name:"radioListOp",value:String(g),onChange:function(e){O(+e.target.value)},row:!0},i.a.createElement(Ee.a,{value:String(1),control:i.a.createElement(be.a,null),label:"\u79fb\u52a8"}),i.a.createElement(Ee.a,{value:String(2),control:i.a.createElement(be.a,null),label:"\u590d\u5236"}))),i.a.createElement("div",{className:s.ctl},i.a.createElement(M.a,{type:"submit",variant:"contained",color:"primary",style:{marginRight:8}},"\u63d0\u4ea4"),i.a.createElement(M.a,{onClick:function(){return r()}},"\u53d6\u6d88"))))))}var oa=a(170),la=function(e){return i.a.createElement(ta,Object.assign({scope:"request",title:"\u8bf7\u6c42\u53c2\u6570",label:"\u8bf7\u6c42"},e))},ca=function(e){return i.a.createElement(ta,Object.assign({scope:"response",title:"\u54cd\u5e94\u5185\u5bb9",label:"\u54cd\u5e94"},e))},ia=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).handleAddMemoryProperty=function(e,t){r.handleAddMemoryProperties([e],t)},r.handleAddMemoryProperties=function(e,t){e.forEach((function(e){void 0===e.memory&&(e.memory=!0),void 0===e.id&&(e.id=s.h.uniqueId("memory-"))}));var a={properties:[].concat(Object(de.a)(r.state.properties),Object(de.a)(e))};r.setState(a,(function(){t&&t(e)}))},r.handleDeleteMemoryProperty=function(e,t){var a=Object(de.a)(r.state.properties),n=a.findIndex((function(t){return t.id===e.id}));if(n>=0){a.splice(n,1);for(var o=[e.id],l=0;l<a.length;l++)-1!==o.indexOf(a[l].parentId)&&(o.push(a[l].id),a.splice(l--,1),l=0);r.setState({properties:a},(function(){t&&t()}))}},r.handleChangeProperty=function(e){var t=Object(de.a)(r.state.properties),a=t.findIndex((function(t){return t.id===e.id}));a>=0&&(t.splice(a,1,e),r.setState({properties:t}))},r.handleChangeInterface=function(e){r.setState({itf:Object(p.a)(Object(p.a)({},r.state.itf),e)})},r.handleSaveInterfaceAndProperties=function(e){e.preventDefault();var t=r.state.itf,a=r.props,n=a.updateProperties,o=a.updateInterface;if(t.name.trim())if(t.url.trim())if("http"===t.url.substring(0,4)||"/"===t.url[0]){var l,c={},i=function(e){return"".concat(e.name,"|").concat(e.parentId,"|").concat(e.scope)},s=Object(ce.a)(r.state.properties);try{for(s.s();!(l=s.n()).done;){var m=l.value;if(!m.name.trim())return void r.props.showMessage("\u6709\u53c2\u6570\u672a\u547d\u540d\uff0c\u8bf7\u68c0\u67e5...".concat(m.description?"\u63cf\u8ff0\u4e3a\uff1a"+m.description:""),yt.a.WARNING);m.name=m.name.trim();var u=i(m);if(c[u]?c[u]++:c[u]=1,c[u]>1)return void r.props.showMessage("\u53c2\u6570".concat(m.name,"\u547d\u540d\u51b2\u7a81\uff0c\u540c\u5c42\u7ea7\u4e0d\u80fd\u6709\u76f8\u540c\u7684\u5c5e\u6027\u540d"),yt.a.WARNING)}}catch(d){s.e(d)}finally{s.f()}o({id:t.id,name:t.name.trim(),url:t.url.trim(),method:t.method,status:t.status,description:t.description},(function(){})),n(r.state.itf.id,r.state.properties,r.state.summaryState,(function(){r.handleUnlockInterface()}))}else r.props.showMessage("\u5408\u6cd5\u7684URL\u5730\u5740\uff0c\u9700\u4ee5 http \u6216 / \u5f00\u5934\uff0c\u4f8b\u5982/a/b \u6216\u8005 https://www.taobao.com",yt.a.WARNING);else r.props.showMessage("URL\u5730\u5740\u4e0d\u80fd\u4e3a\u7a7a",yt.a.WARNING);else r.props.showMessage("\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a",yt.a.WARNING)},r.handleMoveInterface=function(){r.setState({moveInterfaceDialogOpen:!0})},r.handleMoveInterfaceSubmit=function(){},r.handleEditInterface=function(){var e=r.props,t=e.lockInterface;(0,e.fetchInterface)(r.state.itf.id,(function(e){e.locker||t(e.id)}))},r.handleUnlockInterface=function(){var e=r.props,t=e.itf;(0,e.unlockInterface)(t.id)},r.state=Object(p.a)(Object(p.a)({},a.mapPropsToState(e)),{},{summaryState:{bodyOption:e.bodyOption},moveInterfaceDialogOpen:!1}),r.summaryStateChange=r.summaryStateChange.bind(Object(f.a)(r)),r}return Object(r.a)(a,[{key:"getChildContext",value:function(){return s.h.pick(this,Object.keys(a.childContextTypes))}},{key:"summaryStateChange",value:function(e){this.setState({summaryState:e})}},{key:"componentWillReceiveProps",value:function(e){if(e.itf.id!==this.state.itf.id||e.itf.updatedAt!==this.state.itf.updatedAt||e.itf.locker!==this.state.itf.locker||void 0===this.state.properties){var t=this.state;this.setState(a.mapPropsToState(e,t))}}},{key:"fetchInterfaceProperties",value:function(){void 0===this.state.properties&&this.props.fetchInterface(this.state.itf.id,(function(){}))}},{key:"componentDidMount",value:function(){this.fetchInterfaceProperties()}},{key:"componentDidUpdate",value:function(){this.fetchInterfaceProperties()}},{key:"render",value:function(){var e=this,t=this.props,a=t.auth,n=t.repository,r=t.mod,o=this.state,l=o.editable,c=o.itf,s=this.state.itf,m=s.id,u=s.locker,d=s.bodyOption;return m?i.a.createElement("article",{className:"InterfaceEditor"},i.a.createElement(pt,{locker:u,auth:a,repository:n,editable:l,itfId:c.id,moveInterface:this.handleMoveInterface,handleEditInterface:this.handleEditInterface,handleMoveInterface:this.handleMoveInterface,handleSaveInterfaceAndProperties:this.handleSaveInterfaceAndProperties,handleUnlockInterface:this.handleUnlockInterface}),i.a.createElement(It,{repository:n,mod:r,itf:c,active:!0,editable:l,stateChangeHandler:this.summaryStateChange,handleChangeInterface:this.handleChangeInterface}),this.state.properties?i.a.createElement(i.a.Fragment,null,i.a.createElement(la,{properties:this.state.properties,auth:a,editable:l,repository:n,mod:r,interfaceId:c.id,itf:c,bodyOption:d,posFilter:this.state.summaryState.posFilter,handleChangeProperty:this.handleChangeProperty,handleDeleteMemoryProperty:this.handleDeleteMemoryProperty}),i.a.createElement(ca,{properties:this.state.properties,auth:a,editable:l,repository:n,itf:c,mod:r,interfaceId:c.id,handleChangeProperty:this.handleChangeProperty,handleDeleteMemoryProperty:this.handleDeleteMemoryProperty})):i.a.createElement(oa.a,null),this.state.moveInterfaceDialogOpen&&i.a.createElement(ra,{title:"\u79fb\u52a8/\u590d\u5236\u63a5\u53e3",mod:r,repository:n,itfId:c.id,open:this.state.moveInterfaceDialogOpen,onClose:function(){return e.setState({moveInterfaceDialogOpen:!1})}})):null}}],[{key:"mapPropsToState",value:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.auth,r=e.itf,o=!(!r.locker||r.locker.id!==n.id);return Object(p.a)(Object(p.a)({},a),{},{itf:r,properties:o&&a.properties?a.properties:null===(t=r.properties)||void 0===t?void 0:t.map((function(e){return Object(p.a)({},e)})),editable:o})}}]),a}(c.Component);ia.childContextTypes={handleUnlockInterface:s.c.func.isRequired,handleSaveInterfaceAndProperties:s.c.func.isRequired,handleMoveInterface:s.c.func.isRequired,handleAddMemoryProperty:s.c.func.isRequired,handleAddMemoryProperties:s.c.func.isRequired,handleDeleteMemoryProperty:s.c.func.isRequired,handleChangeProperty:s.c.func.isRequired};var sa={lockInterface:X.m,fetchInterface:X.g,unlockInterface:X.v,updateProperties:Dt.j,updateInterface:X.y,showMessage:yt.d},ma=Object(s.i)((function(e){return{auth:e.auth,fetchRepository:pe.q}}),sa)(ia),ua=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={showMore:!1},r}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.props,n=t.repository,r=t.router,o=this.state.showMore;if(!n)return null;var l=a.parseDuplicatedInterfaces(n);if(!l.length)return null;var c=Object(s.e)(r).removeSearch("page").removeSearch("itf");return i.a.createElement("div",{className:"DuplicatedInterfacesWarning"},l.map((function(t,a){return(0===a||o)&&i.a.createElement("div",{key:a,className:"alert alert-warning"},i.a.createElement("span",{className:"title"},0===a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(z.a,{className:"icon"}),i.a.createElement("span",{className:"msg"},"\u8b66\u544a\uff1a\u68c0\u6d4b\u5230 ",l.length," \u7ec4\u91cd\u590d\u63a5\u53e3")),i.a.createElement("span",{className:"itf"},t[0].method," ",t[0].url||"-")),t.map((function(e){return i.a.createElement(s.a,{key:e.id,to:c.setSearch("mod",e.mod.id).setSearch("itf",e.id).href(),className:"mr12"},e.name)})),0===a&&l.length>1&&i.a.createElement("span",{className:"fake-link more-link",onClick:function(){e.setState({showMore:!o})}},o?"\u6536\u8d77":"\u5c55\u5f00"))})))}}],[{key:"parseDuplicatedInterfaces",value:function(e){var t,a={},n=Object(ce.a)(e.modules);try{for(n.s();!(t=n.n()).done;){var r,o=t.value,l=Object(ce.a)(o.interfaces);try{for(l.s();!(r=l.n()).done;){var c=r.value,i="".concat(c.method," ").concat(c.url);a[i]||(a[i]=[]),a[i]=[].concat(Object(de.a)(a[i]),[Object(p.a)(Object(p.a)({},c),{},{mod:o})])}}catch(u){l.e(u)}finally{l.f()}}}catch(u){n.e(u)}finally{n.f()}var s=[];for(var m in a)a[m].length>1&&s.push(a[m]);return s}},{key:"printDuplicatedInterfacesWarning",value:function(e){e.forEach((function(e){var t="".concat(e[0].method," ").concat(e[0].url);console.group("\u8b66\u544a\uff1a\u68c0\u6d4b\u5230\u91cd\u590d\u63a5\u53e3 "+t),e.forEach((function(e){console.warn("#".concat(e.id," ").concat(e.method," ").concat(e.url))})),console.groupEnd()}))}}]),a}(c.Component);ua.contextTypes={store:wt.a.object};var da=Object(I.c)((function(e){return{router:e.router}}))(ua),pa=a(768),fa=(a(752),a(116));function ha(e){var t=e.repoId,a=e.open,n=e.onClose,r=e.title,o="".concat(fa.default.serve,"/export/postman?id=").concat(t),l="".concat(fa.default.serve,"/export/markdown?id=").concat(t,"&origin=").concat(window.location.origin),c="".concat(fa.default.serve,"/export/docx?id=").concat(t,"&origin=").concat(window.location.origin),s="".concat(fa.default.serve,"/repository/get?id=").concat(t);return i.a.createElement(x.a,{open:a,onClose:function(){return n()},TransitionComponent:_.a},i.a.createElement(T.a,null,r),i.a.createElement(D.a,{dividers:!0},i.a.createElement("form",{className:"form-horizontal",onSubmit:function(){return!1}},i.a.createElement("div",{className:"mb5"},i.a.createElement("div",null,"Postman:"),i.a.createElement("div",{className:"alert alert-info",role:"alert",style:{margin:"8px 0"}},i.a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},o)),i.a.createElement("div",null,"\u70b9\u51fb\u4ee5\u4e0a\u94fe\u63a5\u4e0b\u8f7d\uff0c\u5728 Postman \u4e2d\u70b9\u51fb\u5bfc\u5165\uff08Import\uff09\uff0c\u9009\u62e9\u4ece\u6587\u4ef6\u5bfc\u5165\uff08Import File\uff09\u4e0b\u8f7d\u7684\u6587\u4ef6\u3002")),i.a.createElement("div",null,i.a.createElement("div",null,"Markdown:"),i.a.createElement("div",{className:"alert alert-info",role:"alert",style:{margin:"8px 0"}},i.a.createElement("a",{href:l,target:"_blank",rel:"noopener noreferrer"},l))),i.a.createElement("div",null,i.a.createElement("div",null,"Docx:"),i.a.createElement("div",{className:"alert alert-info",role:"alert",style:{margin:"8px 0"}},i.a.createElement("a",{href:c,target:"_blank",rel:"noopener noreferrer"},c))),i.a.createElement("div",null,i.a.createElement("div",null,"RAP Data:"),i.a.createElement("div",{className:"alert alert-info",role:"alert",style:{margin:"8px 0"}},i.a.createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer"},s)),i.a.createElement("div",null,"\u7528\u4e8e\u5907\u4efd\uff0c\u6216\u5728\u5176\u5b83RAP2\u5e73\u53f0\u5bfc\u5165\uff0c\u6253\u5f00\u540e\u53e6\u5b58\u4e3a\u4fdd\u5b58\u5373\u53ef\u3002\u4e5f\u53ef\u901a\u8fc7\u7f16\u7a0b\u8bbf\u95ee\u3002")),i.a.createElement("div",{className:"mt10"},i.a.createElement(M.a,{variant:"outlined",onClick:n},"\u5173\u95ed")))))}var va=a(352),Ea=a(712),ba=a(713),ya=a(83),ga=a(284),Oa=a.n(ga),Na=a(788),ja=a(789),ka=a(790),Ca=a(786),Ia=a(791),Sa=a(753),wa=a.n(Sa),Pa=a(197),Ra=Object(W.a)((function(e){var t=e.spacing;return Object(Ie.a)({appBar:{position:"relative"},title:{marginLeft:t(2),flex:1},btn:{marginBottom:t(2),marginTop:t(2)},topHint:{marginBottom:t(2),marginTop:t(2)}})}));var xa,Ta=Object(Pa.b)((function(e){var t=e.open,a=e.handleClose,n=e.repositoryId,r=e.enqueueSnackbar,o=Ra(),l=Object(c.useState)([]),s=Object(C.a)(l,2),m=s[0],u=s[1],d=Object(I.d)();Object(c.useEffect)((function(){d(Object(pe.h)(n))}),[d,n]);var f=Object(I.e)((function(e){return e.defaultVals}));Object(c.useEffect)((function(){u(f)}),[f]);var h=function(e,t,a){u(m.map((function(n,r){return r===t?Object(p.a)(Object(p.a)({},n),{},Object(ft.a)({},e,a)):n})))};return i.a.createElement(x.a,{fullScreen:!0,open:t,onClose:a,TransitionComponent:_.a},i.a.createElement(Ea.a,{className:o.appBar},i.a.createElement(ba.a,null,i.a.createElement(Qe.a,{edge:"start",color:"inherit",onClick:a,"aria-label":"close"},i.a.createElement(Oa.a,null)),i.a.createElement(ya.a,{variant:"h6",className:o.title},"\u9ed8\u8ba4\u503c\u914d\u7f6e"),i.a.createElement(M.a,{color:"inherit",onClick:function(){d(Object(pe.H)(n,m)),a(),r("\b\u66f4\u65b0\u9ed8\u8ba4\u503c\u6210\u529f",{variant:"success",autoHideDuration:1e3})}},"\u4fdd\u5b58"))),i.a.createElement(D.a,null,i.a.createElement("div",{className:o.topHint},i.a.createElement(ya.a,{variant:"body1"}," \u7cfb\u7edf\u5c06\u6839\u636e\u53d8\u91cf\u540d\u8fdb\u884c\u641c\u7d22\uff0c\u5982\u679c\u751f\u6210\u89c4\u5219\u548c\u521d\u59cb\u503c\u5747\u672a\u586b\u5199\uff0c\u7cfb\u7edf\u624d\u4f1a\u5bf9\u540c\u540d\u53c2\u6570\u7684Mock\u89c4\u5219\u8fdb\u884c\u8986\u76d6\u3002")),i.a.createElement("div",{className:o.btn},i.a.createElement(M.a,{onClick:function(){u([].concat(Object(de.a)(m),[{name:"",rule:"",value:""}]))},color:"primary",variant:"contained",size:"small"},"\u6dfb\u52a0\u4e00\u884c")),i.a.createElement(Na.a,null,i.a.createElement(ja.a,null,i.a.createElement(ka.a,null,i.a.createElement(Ca.a,null,"\u53d8\u91cf\u540d"),i.a.createElement(Ca.a,null,"\u751f\u6210\u89c4\u5219"),i.a.createElement(Ca.a,null,"\u521d\u59cb\u503c"),i.a.createElement(Ca.a,null))),i.a.createElement(Ia.a,null,m.map((function(e,t){return i.a.createElement(ka.a,{key:t},i.a.createElement(Ca.a,{scope:"row"},i.a.createElement(v.a,{value:e.name,onChange:function(e){return h("name",t,e.target.value)},placeholder:"\u8bf7\u8f93\u5165\u53d8\u91cf\u540d"})),i.a.createElement(Ca.a,null,i.a.createElement(v.a,{value:e.rule,onChange:function(e){return h("rule",t,e.target.value)},placeholder:"\u8bf7\u8f93\u5165\u751f\u6210\u89c4\u5219"})),i.a.createElement(Ca.a,null,i.a.createElement(v.a,{value:e.value,onChange:function(e){return h("value",t,e.target.value)},placeholder:"\u8bf7\u8f93\u5165\u521d\u59cb\u503c"})),i.a.createElement(Ca.a,null,i.a.createElement(wa.a,{onClick:function(){return function(e){u(m.filter((function(t,a){return e!==a})))}(t)}})))}))))))})),Da=a(754),Ma=a(671),Aa=Object(W.a)({root:{"&":{fontSize:16}},badge:{display:"flex",justifyContent:"center",alignItems:"center"}});function _a(){var e=Aa();return i.a.createElement("div",{className:e.root},i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement("a",{href:"https://github.com/thx/rapper",target:"_blank",rel:"noopener noreferrer"},i.a.createElement("img",{src:"https://img.alicdn.com/tfs/TB1SlW9lQT2gK0jSZPcXXcKkpXa-1138-220.png",alt:"Logo",width:"250"})),i.a.createElement("h3",null,"\u4e00\u4e2a\u81ea\u5e26\u7c7b\u578b\u7684\u8bf7\u6c42\u5e93\uff08\u5185\u6d4b\uff09"),i.a.createElement("div",{className:e.badge},i.a.createElement("iframe",{title:"star",src:"https://ghbtns.com/github-btn.html?user=thx&repo=rapper&type=star&count=true",scrolling:"0",frameBorder:"0",width:"100px",height:"20px"}),i.a.createElement("a",{href:"https://www.yuque.com/rap/rapper/readme",target:"_blank",rel:"noopener noreferrer"},"\u6587\u6863"))),i.a.createElement("h2",null,"Rapper \u662f\u4ec0\u4e48\uff1f"),i.a.createElement("p",null,"Rapper \u662f TypeScript \u7684\u6700\u4f73\u62cd\u6863\uff0c\u5b83\u53ef\u4ee5\u5e2e\u4f60\u751f\u6210\u5177\u6709\u7c7b\u578b\u5b9a\u4e49\u7684\u8bf7\u6c42\u65b9\u6848\u3002"),i.a.createElement("ul",null,i.a.createElement("li",null,"\u65e0\u9700\u81ea\u884c\u4e66\u5199\u8bf7\u6c42\u4ee3\u7801\uff0c\u628a HTTP \u63a5\u53e3\u5f53\u505a\u51fd\u6570\u8c03\u7528"),i.a.createElement("li",null,"\u8bf7\u6c42\u53c2\u6570/\u8fd4\u56de\u6570\u636e\u7c7b\u578b\u5316\uff0c\u9759\u6001\u6821\u9a8c\u3001\u81ea\u52a8\u8865\u5168\u5feb\u5230\u98de\u8d77"),i.a.createElement("li",null,"\u5bf9 React/Redux \u7279\u522b\u4f18\u5316\uff0c\u63d0\u4f9b\u5168\u5c40\u6570\u636e\u65b9\u6848\uff0chooks \u8f7b\u677e\u4f7f\u7528")),i.a.createElement("p",null,"\u66f4\u591a\u4e86\u89e3\u8bf7\u79fb\u6b65\uff1a",i.a.createElement("a",{href:"https://www.yuque.com/rap/rapper/readme",target:"_blank",rel:"noopener noreferrer"},"\u6587\u6863")),i.a.createElement("p",null,"\u4f7f\u7528\u671f\u95f4\u6709\u7591\u95ee\u6b22\u8fce\u52a0\u5165\u9489\u9489\u7fa4\uff1a21912534"),i.a.createElement("img",{src:"https://img.alicdn.com/tfs/TB1mLzfnF67gK0jSZPfXXahhFXa-828-1068.png",alt:"dingtalk",width:"200"}),i.a.createElement("h2",null,"\u5feb\u901f\u914d\u7f6e"))}var La=Object(W.a)((function(e){var t=e.spacing;return Object(Ie.a)({appBar:{position:"relative"},title:{marginLeft:t(2),flex:1},btn:{marginBottom:t(2),marginTop:t(2)},content:{padding:"30px 15vw 40vh 15vw"},formControl:{margin:0},formItem:{marginBottom:16},formLabel:{fontSize:16,marginBottom:5},step:{fontSize:16,marginBottom:10},mode:{fontSize:12,marginLeft:10}})}));var Ua=function(e){var t=e.open,a=e.handleClose,n=e.repository,r=La(),o=Object(c.useState)("normal"),l=Object(C.a)(o,2),s=l[0],m=l[1],u=Object(c.useState)("src/rapper"),d=Object(C.a)(u,2),p=d[0],f=d[1];return i.a.createElement(x.a,{fullScreen:!0,open:t,onClose:a,TransitionComponent:_.a},i.a.createElement(Ea.a,{className:r.appBar},i.a.createElement(ba.a,null,i.a.createElement(Qe.a,{edge:"start",color:"inherit",onClick:a,"aria-label":"close"},i.a.createElement(Oa.a,null)),i.a.createElement(ya.a,{variant:"h6",className:r.title},"\u5c1d\u8bd5\u7528 Rapper \u5e2e\u4f60\u751f\u6210\u4ee3\u7801"))),i.a.createElement(D.a,{className:r.content},i.a.createElement(_a,null),i.a.createElement("div",{className:r.formItem},i.a.createElement(Ma.a,{component:"legend",className:r.formLabel},"\u751f\u6210\u4ee3\u7801\u7684\u6a21\u5f0f",i.a.createElement("a",{href:"https://www.yuque.com/rap/rapper/which-model",className:r.mode,target:"_blank",rel:"noopener noreferrer"},"\u6211\u8be5\u9009\u62e9\u54ea\u79cd\u6a21\u5f0f\uff1f")),i.a.createElement(ve.a,{"aria-label":"rapperType",row:!0,name:"rapperType",value:s,onChange:function(e,t){m(t)}},i.a.createElement(Ee.a,{value:"normal",control:i.a.createElement(be.a,null),label:"\u57fa\u7840\u6a21\u5f0f"}),i.a.createElement(Ee.a,{value:"redux",control:i.a.createElement(be.a,null),label:"React + Redux \u8fdb\u9636\u6a21\u5f0f"}))),i.a.createElement("div",{className:r.formItem},i.a.createElement(Ma.a,{component:"legend",className:r.formLabel},"Rapper \u751f\u6210\u6587\u4ef6\u7684\u76ee\u5f55\uff08\u76f8\u5bf9\u4e8e\u9879\u76ee\u6839\u76ee\u5f55\uff09"),i.a.createElement(v.a,{placeholder:"src/rapper",fullWidth:!0,margin:"normal",variant:"outlined",value:p,onChange:function(e){return f(e.target.value)}})),i.a.createElement("p",{className:r.step},"1. \u5b89\u88c5 rapper \u5230\u9879\u76ee\u4f9d\u8d56"),i.a.createElement("pre",null,"npm install rap --save"),i.a.createElement("p",{className:r.step},"2. \u7ed9 package.json \u7684 scripts \u5bf9\u8c61\u4e0b\u6dfb\u52a0\u4e0b\u9762\u4e00\u884c\u811a\u672c"),i.a.createElement("pre",null,function(e){var t=e.projectId,a=e.token,n=e.rapperType,r=e.rapperPath,o="".concat(fa.default.serve,"/repository/get?id=").concat(t).concat(a?"&token=".concat(a):""),l=window.location.origin;return String.raw(xa||(xa=Object(Da.a)(['"rapper": "rapper --type ',' --rapperPath "','" --apiUrl "','" --rapUrl "','""'],['"rapper": "rapper --type ',' --rapperPath \\"','\\" --apiUrl \\"','\\" --rapUrl \\"','\\""'])),n,r,o,l)}({projectId:n.id,token:n.token,rapperType:s,rapperPath:p})),i.a.createElement("p",{className:r.step},"3. \u8fd0\u884c rapper \u751f\u6210\u4ee3\u7801"),i.a.createElement("pre",null,"npm run rapper"),i.a.createElement("p",{className:r.step},"4. ",i.a.createElement("a",{href:"https://www.yuque.com/rap/rapper/use",target:"_blank",rel:"noopener noreferrer"},"\u6109\u5feb\u4f7f\u7528\u5427"))))},qa=a(776),Ba=a(12),Fa=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).handleUpdate=function(){var e=r.props.router.location,t=e.pathname,a=e.hash,n=e.search;r.props.replace(t+n+a)},r.state={update:!1,exportPostman:!1,rapperInstallerModalOpen:!1,defaultValuesModalOpen:!1,importSwagger:!1,historyLogDrawerOpen:!1,guideOpen:!1},r}return Object(r.a)(a,[{key:"getChildContext",value:function(){return s.h.pick(this.props,Object.keys(a.childContextTypes))}},{key:"changeDocumentTitle",value:function(){var e=this.props.repository.data;e&&e.name&&(document.title="RAP2 ".concat(e.name))}},{key:"componentDidUpdate",value:function(){this.changeDocumentTitle()}},{key:"componentDidMount",value:function(){var e=this;this.changeDocumentTitle(),this.props.doFetchUserSettings([Ve.a.GUIDE_20200714],(function(t,a){var n;!(null===(n=a.data)||void 0===n?void 0:n.GUIDE_20200714)&&(e.setState({guideOpen:!0}),e.props.updateUserSetting(Ve.a.GUIDE_20200714,"1"))}))}},{key:"componentWillUnmount",value:function(){document.title="RAP2"}},{key:"render",value:function(){var e,t,a,n,r,o,l,c,p=this,f=this.props.location.params,h=this.props.repository;if(!h.fetching&&!h.data)return i.a.createElement("div",{className:"p100 fontsize-30 text-center"},"\u672a\u627e\u5230\u5bf9\u5e94\u4ed3\u5e93");if(h.fetching||!h.data||!h.data.id)return i.a.createElement(u.j,null);var v=h.data;v.name&&(document.title="RAP2 ".concat(v.name));var E=v&&v.modules&&v.modules.length?v.modules.find((function(e){return e.id===+f.mod}))||v.modules[0]:null;if(!(+f.mod>0)&&+f.itf>0){var b,y=null===v||void 0===v||null===(b=v.modules)||void 0===b?void 0:b.filter((function(e){return e.interfaces.map((function(e){return e.id})).indexOf(+f.itf)>-1}));y&&y[0]&&(E=y[0])}var g=(null===(e=E)||void 0===e?void 0:e.interfaces)&&(null===(t=E)||void 0===t||null===(a=t.interfaces)||void 0===a?void 0:a.length)?(null===(n=E)||void 0===n||null===(r=n.interfaces)||void 0===r?void 0:r.find((function(e){return e.id===+f.itf})))||(null===(o=E)||void 0===o?void 0:o.interfaces[0]):{},O=v.organization?"/organization/repository?organization=".concat(v.organization.id):"/repository/joined?user=".concat(v.owner.id);return i.a.createElement("article",{className:"RepositoryEditor"},i.a.createElement("div",{className:"header"},i.a.createElement("span",{className:"title"},i.a.createElement(z.t,{className:"mr6 color-9"}),i.a.createElement(s.a,{to:"".concat(O),className:"g-link"},v.organization?v.organization.name:v.owner.fullname),i.a.createElement("span",{className:"slash"}," / "),i.a.createElement("span",null,v.name)),i.a.createElement("div",{className:"toolbar"},v.canUserEdit?i.a.createElement("span",{className:"g-link edit mr1",onClick:function(){return p.setState({update:!0})}},i.a.createElement(z.o,null)," \u7f16\u8f91"):null,i.a.createElement(d.a,{open:this.state.update,onClose:function(e){e&&p.handleUpdate(),p.setState({update:!1})},title:"\u7f16\u8f91\u4ed3\u5e93",repository:v}),i.a.createElement("a",{href:"".concat(m.c,"/app/plugin/").concat(v.id),target:"_blank",rel:"noopener noreferrer",className:"g-link"},i.a.createElement(z.q,null)," \u63d2\u4ef6"),i.a.createElement("a",{href:"".concat(m.c,"/repository/get?id=").concat(v.id,"&token=").concat(v.token),target:"_blank",rel:"noopener noreferrer",className:"g-link"},i.a.createElement(z.h,null)," \u6570\u636e"),i.a.createElement("span",{className:"g-link edit mr1",onClick:function(){return p.setState({importSwagger:!0})}},i.a.createElement(z.k,null)," \u5bfc\u5165"),i.a.createElement(va.b,{open:this.state.importSwagger,onClose:function(e){e&&p.handleUpdate(),p.setState({importSwagger:!1})},repositoryId:v.id,orgId:(v.organization||{}).id,modId:+(null===(l=E)||void 0===l?void 0:l.id)||0,mode:"manual"}),i.a.createElement("span",{className:"g-link edit mr1",onClick:function(){return p.setState({exportPostman:!0})}},i.a.createElement(z.k,null)," \u5bfc\u51fa"),i.a.createElement(ha,{title:"\u5bfc\u51fa",open:this.state.exportPostman,repoId:v.id,onClose:function(){return p.setState({exportPostman:!1})}}),i.a.createElement("span",{className:"g-link edit mr1",onClick:function(){return p.setState({defaultValuesModalOpen:!0})}},i.a.createElement(z.i,null)," \u9ed8\u8ba4\u503c"),i.a.createElement("span",{className:"g-link edit mr1 guide-1",onClick:function(){return p.setState({historyLogDrawerOpen:!0})}},i.a.createElement(pa.a,null)," \u5386\u53f2"),i.a.createElement(Ta,{open:this.state.defaultValuesModalOpen,handleClose:function(){return p.setState({defaultValuesModalOpen:!1})},repositoryId:v.id}),i.a.createElement(st,{open:this.state.historyLogDrawerOpen,onClose:function(){return p.setState({historyLogDrawerOpen:!1})},entityId:null===v||void 0===v?void 0:v.id,entityType:Ve.b.REPOSITORY}),i.a.createElement("span",{className:"g-link edit",onClick:function(){return p.setState({rapperInstallerModalOpen:!0})}},i.a.createElement(z.g,null)," Rapper"),i.a.createElement(Ua,{open:this.state.rapperInstallerModalOpen,handleClose:function(){return p.setState({rapperInstallerModalOpen:!1})},repository:v})),i.a.createElement(k,{repository:v}),i.a.createElement("div",{className:"desc"},i.a.createElement(at.a,null,v.description||"")),this.renderRelatedProjects(),i.a.createElement(da,{repository:v})),i.a.createElement("div",{className:"body"},i.a.createElement(Q,{mods:v.modules,repository:v,mod:E}),i.a.createElement("div",{className:"InterfaceWrapper"},i.a.createElement(Ce,{itfs:(null===(c=E)||void 0===c?void 0:c.interfaces)||[],repository:v,mod:E,itf:g}),i.a.createElement(ma,{itf:g,mod:E,repository:v}))),i.a.createElement(qa.a,{continuous:!0,scrollToFirstStep:!0,showProgress:!0,showSkipButton:!0,run:this.state.guideOpen,locale:{skip:"\u8df3\u8fc7",next:"\u4e0b\u4e00\u6b65",back:"\u4e0a\u4e00\u6b65",last:"\u5b8c\u6210"},steps:[{title:"\u5386\u53f2\u8bb0\u5f55\u4e0a\u7ebf",disableBeacon:!0,content:i.a.createElement(ya.a,{variant:"h6"},"\u73b0\u5728\u60a8\u53ef\u4ee5\u67e5\u770b\u9879\u76ee\u4fee\u6539\u5386\u53f2\u4e86!"),placement:"top",target:".guide-1"},{title:"\u5386\u53f2\u8bb0\u5f55\u4e0a\u7ebf",disableBeacon:!0,content:i.a.createElement(ya.a,{variant:"h6"},"\u60a8\u4e5f\u53ef\u4ee5\u67e5\u770b\u6307\u5b9a\u63a5\u53e3\u7684\u6240\u6709\u6539\u52a8\u8bb0\u5f55\u3002"),placement:"top",target:".guide-2"},{title:"\u76ae\u80a4\u81ea\u5b9a\u4e49\u4e0a\u7ebf",disableBeacon:!0,content:i.a.createElement(ya.a,{variant:"h6"},"\u5728\u7cfb\u7edf\u504f\u597d\u8bbe\u7f6e\u91cc\uff0c\u9009\u62e9\u4e00\u4e2a\u559c\u7231\u7684\u989c\u8272\u5427\uff01\u6bd4\u5982\u539f\u8c05\u7eff\uff1f"),placement:"top",target:".guide-3"}]}))}},{key:"renderRelatedProjects",value:function(){var e=this.props.repository.data.collaborators;return i.a.createElement("div",{className:"RelatedProjects"},e&&Array.isArray(e)&&e.map((function(e){return i.a.createElement("div",{className:"CollabProject Project",key:"collab-".concat(e.id)},i.a.createElement("span",{className:"title"},i.a.createElement(z.y,{className:"mr5"}),"\u534f\u540c"),i.a.createElement(s.a,{to:"/repository/editor?id=".concat(e.id)},e.name))})))}}]),a}(c.Component);Fa.childContextTypes={onAddRepository:s.c.func.isRequired,onUpdateRepository:s.c.func.isRequired,onAddModule:s.c.func.isRequired,onUpdateModule:s.c.func.isRequired,onDeleteModule:s.c.func.isRequired,onSortModuleList:s.c.func.isRequired,onAddInterface:s.c.func.isRequired,onUpdateInterface:s.c.func.isRequired,onDeleteInterface:s.c.func.isRequired,onLockInterface:s.c.func.isRequired,onUnlockInterface:s.c.func.isRequired,onAddProperty:s.c.func.isRequired,onUpdateProperty:s.c.func.isRequired,onUpdateProperties:s.c.func.isRequired,onDeleteProperty:s.c.func.isRequired,onSortPropertyList:s.c.func.isRequired};var za={onFetchRepository:pe.q,onAddRepository:pe.a,onUpdateRepository:pe.K,onClearRepository:pe.d,onAddModule:L.a,onUpdateModule:L.k,onDeleteModule:L.d,onSortModuleList:L.h,onAddInterface:X.a,onUpdateInterface:X.y,onDeleteInterface:X.d,onLockInterface:X.m,onUnlockInterface:X.v,onAddProperty:Dt.a,onUpdateProperty:Dt.m,onUpdateProperties:Dt.j,onDeleteProperty:Dt.d,onSortPropertyList:Dt.g,replace:s.n,doFetchUserSettings:Ba.t,updateUserSetting:Ba.W};t.default=Object(s.i)((function(e){return{auth:e.auth,repository:e.repository,router:e.router}}),za)(Fa)}}]);
//# sourceMappingURL=RepositoryEditor.81cb663a.chunk.js.map