(this["webpackJsonprap2-dolores"]=this["webpackJsonprap2-dolores"]||[]).push([[7],{726:function(e,t,a){"use strict";var n=a(31),r=a(32),o=a(34),c=a(33),l=a(0),i=a.n(l),s=a(19),m=(a(728),function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={curVal:e.curVal},r}return Object(r.a)(a,[{key:"handleChange",value:function(e){e.target.value!==this.state.curVal&&(this.setState({curVal:e.target.value}),this.props.onChange&&this.props.onChange(e.target.value))}},{key:"render",value:function(){var e=this,t=this;return i.a.createElement("div",{className:"ctl-radio-list"},this.props.data.map((function(a){return i.a.createElement("label",{className:"label mr8",key:a.value},i.a.createElement("input",{className:"input",type:"radio",name:t.props.name,value:a.value,disabled:t.props.disabled,checked:e.state.curVal+""===a.value+"","data-log":typeof e.state.curVal+"|"+typeof a.value,onChange:function(e){return t.handleChange(e)}}),a.label)})))}}]),a}(l.Component));t.a=Object(s.c)((function(){return{}}),{})(m)},727:function(e,t,a){"use strict";var n=a(7),r=a.n(n),o=a(122),c=a(3),l=a(0),i=a.n(l),s=a(19),m=a(726),u=a(167),d=a(60),p=a(109),f=a(98),b=a(215),v=a(216),h=a(217),E=a(120),j=a(270),g=a(121),O=a(220),y=a(46),N=a(63),w=a(21),C=a(29),k=Object(j.a)((function(e){var t=e.spacing;return{root:{},appBar:{position:"relative"},title:{marginLeft:t(2),flex:1},preview:{marginTop:t(1)},form:{minWidth:500,minHeight:300},formTitle:{color:"rgba(0, 0, 0, 0.54)",fontSize:9},formItem:{marginBottom:t(1)},ctl:{marginTop:t(3)}}})),R=f.object().shape({name:f.string().required(u.b.REQUIRED).max(20,u.b.MAX_LENGTH(20)),description:f.string().max(1e3,u.b.MAX_LENGTH(1e3))}),S={id:0,name:"",description:"",members:[],visibility:!1};t.a=function(e){var t=e.open,a=e.onClose,n=e.organization,l=Object(s.e)((function(e){return e.auth})),f=k(),j=Object(s.d)();return i.a.createElement(b.a,{open:t,onClose:function(e,t){return"backdropClick"!==t&&a()},TransitionComponent:g.a},i.a.createElement(v.a,null,"\u65b0\u5efa\u56e2\u961f"),i.a.createElement(h.a,{dividers:!0},i.a.createElement("div",{className:f.form},i.a.createElement(d.c,{initialValues:Object(c.a)(Object(c.a)({},S),n||{}),validationSchema:R,onSubmit:function(e){var t=e.id?w.v:w.a,n=Object(c.a)(Object(c.a)({},e),{},{memberIds:(e.members||[]).map((function(e){return e.id}))}),r=e.owner,o=e.newOwner;o&&o.id!==r.id&&(n.ownerId=o.id),j(t(n,(function(){j(Object(C.c)()),a(!0)})))},render:function(e){var t=e.isSubmitting,n=e.setFieldValue,c=e.values;function s(e){return new Promise(function(){var t=Object(o.a)(r.a.mark((function t(a){var n,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.fetchUserList({name:e});case 2:n=t.sent,o=N.differenceWith(n.data,c.members||[],N.isEqual),a(o.map((function(e){return{label:"".concat(e.fullname," ").concat(e.empId||e.email),value:e.id}})));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}var b=c.newOwner?[{label:c.newOwner.fullname,value:c.newOwner.id}]:c.owner?[{label:c.owner.fullname,value:c.owner.id}]:[];return i.a.createElement(d.b,null,i.a.createElement("div",{className:"rmodal-body"},c.id>0&&i.a.createElement("div",{className:f.formItem},i.a.createElement("div",{className:f.formTitle},"\u9879\u76eeOwner"),c.owner&&c.owner.id===l.id?i.a.createElement(O.a,{isMulti:!1,value:b,loadOptions:s,onChange:function(e){n("newOwner",e[0])}}):i.a.createElement("div",{className:"pt7 pl9"},c.owner.fullname)),i.a.createElement("div",{className:f.formItem},i.a.createElement(m.a,{data:u.a.RADIO_LIST_DATA_VISIBILITY,curVal:c.visibility,name:"visibility",onChange:function(e){return n("visibility",e)}})),i.a.createElement("div",{className:f.formItem},i.a.createElement(d.a,{name:"name",label:"\u56e2\u961f\u540d\u79f0",component:p.a,fullWidth:!0})),i.a.createElement("div",{className:f.formItem},i.a.createElement(d.a,{name:"description",label:"\u63cf\u8ff0",component:p.a,fullWidth:!0})),i.a.createElement("div",{className:f.formItem},i.a.createElement("div",{className:f.formTitle},"\u56e2\u961f\u6210\u5458"),i.a.createElement(O.a,{isMulti:!0,loadOptions:s,selected:c.members.map((function(e){return{label:e.fullname,value:e.id}})),onChange:function(e){return n("members",e)}}))),i.a.createElement("div",{className:f.ctl},i.a.createElement(E.a,{type:"submit",variant:"contained",color:"primary",className:"mr1",disabled:t},"\u63d0\u4ea4"),i.a.createElement(E.a,{onClick:function(){return a()},disabled:t},"\u53d6\u6d88")))}}))))}},728:function(e,t,a){},729:function(e,t,a){},730:function(e,t,a){},731:function(e,t,a){"use strict";a.d(t,"g",(function(){return A})),a.d(t,"a",(function(){return T})),a.d(t,"d",(function(){return z})),a.d(t,"f",(function(){return U})),a.d(t,"e",(function(){return L})),a.d(t,"b",(function(){return V})),a.d(t,"c",(function(){return B}));var n=a(31),r=a(32),o=a(34),c=a(33),l=a(28),i=a(0),s=a.n(i),m=a(62),u=a(52),d=a(8),p=a(273),f=a(166),b=a(714),v=a(13);var h={deleteRepository:v.e,replace:m.n},E=Object(m.i)((function(e){return{auth:e.auth,router:e.router}}),h)((function(e){var t=e.auth,a=e.repository,n=e.editor,r=e.router,o=Object(i.useState)(!1),c=Object(l.a)(o,2),u=c[0],v=c[1],h=r.location;return s.a.createElement(b.a,{className:"Repository card"},s.a.createElement("div",{className:"card-block"},s.a.createElement("div",{className:"name"},s.a.createElement(f.t,{className:"mr6 color-9"}),s.a.createElement(m.a,{to:"".concat(n,"?id=").concat(a.id)},a.name)),s.a.createElement("div",{className:"desc"},a.description),s.a.createElement("div",{className:"toolbar"},s.a.createElement("a",{href:"".concat(d.c,"/app/plugin/").concat(a.id),target:"_blank",rel:"noopener noreferrer"},s.a.createElement(f.q,null)),a.canUserEdit?s.a.createElement("span",{className:"fake-link",onClick:function(){return v(!0)}},s.a.createElement(f.o,null)):null,s.a.createElement(p.a,{title:"\u7f16\u8f91\u4ed3\u5e93",open:u,onClose:function(){return v(!1)},repository:a}),a.owner.id===t.id?s.a.createElement(m.a,{to:h.pathname+h.search,onClick:function(t){t.preventDefault();var a=e.repository,n=e.router,r=e.replace,o="\u4ed3\u5e93\u88ab\u5220\u9664\u540e\u4e0d\u53ef\u6062\u590d\uff0c\u5e76\u4e14\u4f1a\u5220\u9664\u76f8\u5173\u7684\u6a21\u5757\u548c\u63a5\u53e3\uff01\n\u786e\u8ba4\u7ee7\u7eed\u5220\u9664\u300e#".concat(a.id," ").concat(a.name,"\u300f\u5417\uff1f");if(window.confirm(o)){(0,e.deleteRepository)(a.id);var c=n.location;r(c.pathname+c.hash+c.search)}}},s.a.createElement(f.x,null)):null)),s.a.createElement("div",{className:"card-block card-footer"},a.organization?s.a.createElement("span",{className:"ownername"},s.a.createElement(f.m,null)," ",a.organization.name):s.a.createElement("span",{className:"ownername"},s.a.createElement(f.p,null)," ",a.owner.fullname),s.a.createElement("span",{className:"fromnow"},Object(m.k)(a.updatedAt).fromNow(),"\u66f4\u65b0")))})),j=function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.repositories,n=e.editor;return a.length?s.a.createElement("div",{className:"RepositoryList row"},a.map((function(e){return s.a.createElement("div",{key:e.id},s.a.createElement(E,{repository:e,editor:n}))}))):t?s.a.createElement("div",{className:"fontsize-20 text-center p50"},"\u6ca1\u6709\u627e\u5230\u5339\u914d ",s.a.createElement("strong",null,t)," \u7684\u4ed3\u5e93"):s.a.createElement("div",{className:"fontsize-20 text-center p50"},"\u6ca1\u6709\u6570\u636e")}}]),a}(i.Component),g=a(2),O=a.n(g),y=a(19),N=a(726),w=(a(729),a(666)),C=a(120),k=function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).handleSubmit=function(e){r.setState({disableSubmit:!0}),e.preventDefault();var t=r.state,a=t.docUrl,n=t.orgId,o=t.version,c=t.projectData;r.props.importRepository({docUrl:a,orgId:n,version:o,projectData:c},(function(e){r.setState({disableSubmit:!1}),e.isOk&&r.context.rmodal.resolve()}))},r.state={orgId:e.orgId,version:1,docUrl:"",disableSubmit:!1,projectData:""},r}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.context.rmodal,a=this.state,n=a.disableSubmit,r=a.version,o=a.projectData;return s.a.createElement("section",{className:"ImportRepositoryForm"},s.a.createElement("div",{className:"rmodal-header"},s.a.createElement("span",{className:"rmodal-title"},this.props.title)),s.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"rmodal-body"},s.a.createElement("div",{className:"form-group row"},s.a.createElement("label",{className:"col-sm-4 control-label"},"\u7248\u672c"),s.a.createElement("div",{className:"col-sm-10"},s.a.createElement(N.a,{data:[{label:"RAP1\u5728\u7ebf\u5730\u5740",value:1},{label:"RAP1 Data",value:2},{label:"RAP2 Data",value:3}],curVal:r,name:"version",onChange:function(t){return e.setState({version:t})}}))),1===+r&&s.a.createElement("div",{className:"form-group row"},s.a.createElement("label",{className:"col-sm-4 control-label"},"\u6587\u6863URL"),s.a.createElement("div",{className:"col-sm-10"},s.a.createElement("input",{name:"projectId",value:this.state.docUrl,onChange:function(t){return e.setState({docUrl:t.target.value})},className:"form-control",placeholder:"http://rapapi.org/workspace/myWorkspace.do?projectId=145#2548",spellCheck:!1,autoFocus:!0,required:!0,"data-parsley-maxlength":"256",style:{width:500}}))),(2===+r||3===+r)&&s.a.createElement("div",{className:"form-group row"},s.a.createElement("label",{className:"col-sm-4 control-label"},"\u6587\u6863\u6570\u636e"),s.a.createElement("div",{className:"col-sm-10"},s.a.createElement(w.a,{value:o,onChange:function(t){return e.setState({projectData:t.target.value})},placeholder:"\u8bf7\u5c06projectData\u7c98\u8d34\u5230\u6b64\u5904",multiline:!0,style:{width:600,height:300,margin:16},rowsMax:10}))),s.a.createElement("div",{className:"form-group row mb0"},s.a.createElement("label",{className:"col-sm-2 control-label"}),s.a.createElement("div",{className:"col-sm-10"},s.a.createElement(C.a,{type:"submit",id:"btnSubmitImportRAP",disabled:n,variant:"contained",color:"primary",style:{marginRight:8}},n?"\u5bfc\u5165\u4e2d\uff0c\u8bf7\u7a0d\u7b49...":"\u63d0\u4ea4"),s.a.createElement(C.a,{onClick:function(){return t.close()}},"\u53d6\u6d88"))))))}},{key:"componentDidUpdate",value:function(){this.context.rmodal.reposition()}}]),a}(i.Component);k.contextTypes={rmodal:O.a.object.isRequired};var R={importRepository:v.z,fetchRepositoryList:v.v},S=Object(y.c)(null,R)(k),I=a(673),x=a(664),D=a(727),A={onAddRepository:v.a,onUpdateRepository:v.K,onDeleteRepository:v.e};function T(e){var t=e.organization,a=e.callback,n=Object(i.useState)(!1),r=Object(l.a)(n,2),o=r[0],c=r[1],d=Object(i.useState)(!1),b=Object(l.a)(d,2),v=b[0],h=b[1],E=Object(i.useState)(!1),j=Object(l.a)(E,2),g=j[0],O=j[1],N=Object(y.d)(),w=Object(y.e)((function(e){return e.router}));return s.a.createElement("span",{className:"float-right ml10"},t&&s.a.createElement(C.a,{style:{marginRight:8},className:"RepositoryCreateButton",variant:"contained",color:"primary",onClick:function(){return O(!0)}},"\u7f16\u8f91\u56e2\u961f"),s.a.createElement(D.a,{organization:t,open:g,onClose:function(){return O(!1)}}),s.a.createElement(C.a,{className:"RepositoryCreateButton",variant:"contained",color:"primary",onClick:function(){return c(!0)}},"\u65b0\u5efa\u4ed3\u5e93"),s.a.createElement(p.a,{title:"\u65b0\u5efa\u4ed3\u5e93",open:o,onClose:function(){return c(!1)},organizationId:t?t.id:void 0}),t&&s.a.createElement(C.a,{style:{marginLeft:8},className:"RepositoryCreateButton",variant:"contained",color:"primary",onClick:function(){return h(!0)}},s.a.createElement(f.b,null)," \u5bfc\u5165\u4ed3\u5e93"),t&&s.a.createElement(u.g,{when:v&&!!t,onClose:function(){return h(!1)},onResolve:function(){if(a)N(Object(m.n)(a));else{var e=Object(m.e)(w);N(Object(m.n)(e.href()))}}},s.a.createElement(S,{title:"\u5bfc\u5165\u4ed3\u5e93",orgId:t.id})))}function z(e){var t=e.url,a=Object(y.d)();return s.a.createElement(I.a,{className:"mr8",value:t,onChange:function(e){return function(e){a(Object(m.l)(e))}(e.target.value)}},s.a.createElement(x.a,{value:"/repository/joined"},"\u6211\u7684\u4ed3\u5e93"),s.a.createElement(x.a,{value:"/repository/all"},"\u6240\u6709\u4ed3\u5e93"))}function U(e){var t=e.name,a=Object(y.d)(),n=Object(y.e)((function(e){return e.router})),r=Object(i.useState)(""),o=Object(l.a)(r,2),c=o[0],u=o[1];return Object(i.useEffect)((function(){u(t)}),[t]),s.a.createElement(w.a,{value:c||"",placeholder:"\u641c\u7d22\u4ed3\u5e93\uff1a\u540d\u79f0\u3001ID",autoComplete:"off",onChange:function(e){return u(e.target.value.trim())},onKeyUp:function(e){return 13===e.which&&function(){var e=n.location,t=e.pathname,r=e.hash,o=e.search,l=Object(m.g)(t+r+o).removeSearch("cursor");c?l.setSearch("name",c):l.removeSearch("name"),a(Object(m.l)(l.href()))}()},style:{width:200}})}var L=function(e){var t=e.name,a=e.repositories;return a.fetching?s.a.createElement(u.j,null):s.a.createElement(j,{name:t,repositories:a.data,editor:"/repository/editor"})},V=function(e){var t=e.name,a=e.repositories;return a.fetching?s.a.createElement(u.j,null):s.a.createElement(j,{name:t,repositories:a.data,editor:"/organization/repository/editor"})},B=function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.calculated,t=this.context.location;return s.a.createElement(u.d,{location:t,calculated:e})}}]),a}(i.Component);B.contextTypes={location:m.c.object}},781:function(e,t,a){"use strict";a.r(t);var n=a(27),r=a(31),o=a(32),c=a(34),l=a(33),i=a(0),s=a.n(i),m=a(19),u=a(731),d=a(63),p=a.n(d),f=a(154),b=a.n(f),v=(a(730),function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.location,a=e.match,n=e.auth,r=e.repositories;return s.a.createElement("section",{className:"RepositoryListWrapper"},s.a.createElement("nav",{className:"toolbar clearfix"},t.params.user&&+t.params.user!==n.id?null:s.a.createElement(u.d,{url:a.url}),s.a.createElement(u.f,{name:t.params.name}),t.params.user&&+t.params.user!==n.id?null:s.a.createElement(u.a,{callback:"/repository/joined"})),s.a.createElement("div",{className:"body"},s.a.createElement(u.e,{name:t.params.name,repositories:r})),s.a.createElement("div",{className:"footer"},s.a.createElement(u.c,{calculated:r.pagination})))}}]),a}(i.Component));t.default=Object(m.c)((function(e){return{auth:e.auth,repositories:{fetching:e.ownedRepositories.fetching||e.joinedRepositories.fetching,data:p.a.uniqBy([].concat(Object(n.a)(e.ownedRepositories.data),Object(n.a)(e.joinedRepositories.data)),"id").sort((function(e,t){return b()(t.updatedAt).diff(e.updatedAt)}))}}}),u.g)(v)}}]);
//# sourceMappingURL=JoinedRepositoryList.095ba1bf.chunk.js.map